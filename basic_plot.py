import matplotlib.pyplot as plt
import numpy as np
from qppg import q_ppg
from cheby2 import cheby_filter
import copy


orig = [84008, 84031, 84028, 84024, 84031, 84035, 84064, 84079, 84097, 84110, 84133, 84146, 84162, 84162, 84185, 84197, 84202, 84225, 84222, 84231, 84250, 84259, 84269, 84272, 84287, 84290, 84315, 84318, 84350, 84343, 84322, 84275, 83956, 83907, 83858, 83872, 83884, 83896, 83911, 83933, 83915, 83934, 83938, 83975, 83994, 84017, 84029, 84029, 84022, 84023, 84019, 84045, 84041, 84047, 84074, 84082, 84094, 84102, 84121, 84143, 84149, 84150, 84150, 84182, 84183, 84186, 84216, 84221, 84229, 84227, 84246, 84256, 84269, 84284, 84291, 84288, 84237, 84129, 83996, 83914, 83880, 83874, 83874, 83897, 83904, 83930, 83929, 83929, 83935, 83965, 83965, 83978, 83975, 83972, 83961, 83957, 83922, 83929, 83929, 83904, 83899, 83868, 83866, 83849, 83850, 83833, 83829, 83825, 83815, 83820, 83808, 83801, 83791, 83790, 83800, 83790, 83801, 83795, 83778, 83728, 83672, 83587, 83516, 83491, 83471, 83449, 83440, 83432, 83426, 83405, 83412, 83410, 83429, 83423, 83438, 83437, 83436, 83428, 83437, 83442, 83445, 83453, 83449, 83467, 83476, 83490, 83495, 83493, 83508, 83522, 83540, 83539, 83546, 83554, 83567, 83585, 83597, 83601, 83623, 83635, 83633, 83649, 83654, 83679, 83673, 83710, 83718, 83722, 83703, 83633, 83561, 83506, 83435, 83408, 83404, 83413, 83420, 83411, 83405, 83399, 83398, 83403, 83409, 83443, 83433, 83452, 83446, 83451, 83447, 83444, 83465, 83452, 83471, 83486, 83488, 83514, 83523, 83527, 83545, 83556, 83560, 83577, 83585, 83595, 83613, 83611, 83624, 83645, 83660, 83668, 83688, 83709, 83706, 83731, 83749, 83718, 83642, 83569, 83512, 83459, 83445, 83434, 83423, 83448, 83471, 83461, 83449, 83452, 83460, 83469, 83485, 83479, 83485, 83498, 83501, 83491, 83507, 83518, 83517, 83535, 83550, 83550, 83564, 83571, 83587, 83591, 83608, 83603, 83613, 83634, 83636, 83665, 83643, 83670, 83683, 83687, 83684, 83714, 83711, 83685, 83618, 83567, 83537, 83518, 83507, 83517, 83523, 83534, 83547, 83551, 83545, 83553, 83568, 83580, 83578, 83572, 83581, 83593, 83604, 83608, 83605, 83609, 83622, 83649, 83649, 83653, 83674, 83677, 83674, 83702, 83702, 83708, 83724, 83747, 83744, 83762, 83777, 83785, 83808, 83809, 83803, 83772, 83713, 83659, 83617, 83573, 83586, 83583, 83592, 83589, 83585, 83575, 83571, 83575, 83593, 83590, 83594, 83613, 83597, 83619, 83614, 83615, 83632, 83620, 83635, 83641, 83655, 83660, 83664, 83685, 83694, 83693, 83711, 83717, 83723, 83742, 83747, 83746, 83770, 83770, 83777, 83805, 83813, 83828, 83837, 83838, 83838, 83784, 83740, 83692, 83669, 83657, 83638, 83648, 83643, 83639, 83653, 83647, 83644, 83670, 83680, 83682, 83695, 83697, 83699, 83694, 83703, 83722, 83713, 83725, 83744, 83741, 83747, 83739, 83765, 83781, 83781, 83769, 83793, 83808, 83810, 83830, 83836, 83836, 83847, 83869, 83890, 83889, 83890, 83854, 83828, 83786, 83750, 83742, 83731, 83747, 83744, 83741, 83752, 83757, 83750, 83765, 83772, 83759, 83778, 83775, 83776, 83767, 83777, 83779, 83784, 83792, 83801, 83809, 83795, 83822, 83842, 83842, 83830, 83838, 83852, 83866, 83879, 83886, 83898, 83925, 83929, 83937, 83914, 83889, 83844, 83801, 83765, 83758, 83752, 83752, 83752, 83757, 83742, 83745, 83760, 83764, 83787, 83793, 83795, 83796, 83796, 83797, 83801, 83809, 83820, 83837, 83834, 83850, 83856, 83867, 83878, 83879, 83881, 83897, 83907, 83917, 83907, 83912, 83935, 83934, 83950, 83951, 83974, 83973, 83963, 83917, 83884, 83821, 83808, 83775, 83767, 83763, 83768, 83764, 83750, 83755, 83764, 83770, 83793, 83795, 83800, 83807, 83804, 83809, 83817, 83806, 83827, 83826, 83845, 83833, 83854, 83876, 83872, 83881, 83897, 83903, 83901, 83928, 83930, 83929, 83945, 83948, 83963, 83970, 83977, 83997, 84011, 84017, 84043, 84046, 84051, 84029, 83986, 83930, 83894, 83863, 83851, 83858, 83846, 83865, 83852, 83854, 83863, 83859, 83868, 83888, 83919, 83899, 83905, 83914, 83926, 83917, 83906, 83928, 83954, 83960, 83969, 83956, 83980, 83996, 83994, 83998, 84007, 84019, 84034, 84026, 84048, 84047, 84055, 84072, 84074, 84067, 84061, 84021, 83962, 83921, 83901, 83887, 83885, 83893, 83895, 83893, 83889, 83893, 83914, 83924, 83915, 83926, 83902, 83919, 83929, 83943, 83945, 83958, 83961, 83950, 83968, 83975, 83967, 83985, 83996, 84007, 84006, 84016, 84017, 84031, 84038, 84064, 84055, 84061, 84075, 84085, 84081, 84064, 84006, 83970, 83931, 83885, 83869, 83855, 83846, 83852, 83849, 83841, 83834, 83840, 83833, 83853, 83847, 83840, 83860, 83865, 83868, 83865, 83878, 83884, 83903, 83893, 83911, 83920, 83932, 83943, 83953, 83950, 83963, 83977, 83987, 83990, 83998, 84002, 84019, 84020, 84036, 84047, 84060, 84079, 84073, 84038, 83990, 83939, 83888, 83857, 83833, 83825, 83825, 83816, 83824, 83823, 83819, 83826, 83833, 83843, 83862, 83869, 83867, 83853, 83863, 83864, 83866, 83866, 83866, 83889, 83899, 83897, 83901, 83918, 83936, 83936, 83928, 83939, 83945, 83949, 83951, 83953, 83969, 83983, 83991, 84006, 84008, 84018, 84004, 83969, 83903, 83831, 83783, 83739, 83728, 83707, 83692, 83702, 83676, 83665, 83655, 83655, 83659, 83654, 83645, 83649, 83626, 83607, 83607, 83591, 83597, 83581, 83594, 83610, 83597, 83595, 83604, 83617, 83602, 83619, 83624, 83621, 83646, 83650, 83653, 83671, 83667, 83687, 83673, 83631, 83579, 83518, 83461, 83439, 83428, 83403, 83399, 83393, 83358, 83378, 83392, 83397, 83405, 83420, 83427, 83419, 83424, 83427, 83436, 83453, 83446, 83469, 83470, 83475, 83516, 83521, 83520, 83546, 83563, 83574, 83598, 83601, 83609, 83625, 83642, 83647, 83674, 83687, 83681, 83706, 83708, 83641, 83594, 83536, 83497, 83449, 83431, 83437, 83422, 83439, 83430, 83408, 83418, 83427, 83434, 83451, 83464, 83482, 83480, 83486, 83492, 83495, 83507, 83523, 83538, 83546, 83561, 83571, 83590, 83605, 83616, 83626, 83627, 83658, 83663, 83678, 83694, 83708, 83740, 83750, 83756, 83779, 83782, 83805, 83804, 83814, 83824, 83822, 83757, 83699, 83634, 83606, 83571, 83560, 83565, 83557, 83556, 83555, 83529, 83537, 83546, 83578, 83585, 83589]
orig1 = copy.deepcopy(orig)
# orig = np.random.normal(53000, 20, 832)

for i in range(832):
    print("%.2f" % orig[i], end=", ")
print()

# vals = [5453.811523, 29637.947266, 69888.632812, 96501.726562, 93711.179688, 81254.945312, 79022.148438, 84029.781250, 86325.843750, 84665.062500, 83228.429688, 83637.835938, 84411.859375, 84440.632812, 84112.640625, 84030.476562, 84173.398438, 84262.195312, 84234.351562, 84199.882812, 84214.117188, 84244.335938, 84259.562500, 84263.578125, 84268.765625, 84278.070312, 84288.984375, 84301.000000, 84315.375000, 84331.601562, 84343.382812, 84338.007812, 84289.640625, 84162.093750, 83978.640625, 83847.359375, 83831.390625, 83874.976562, 83903.382812, 83907.257812, 83912.164062, 83923.734375, 83930.695312, 83935.382812, 83950.773438, 83978.414062, 84006.335938, 84024.125000, 84030.320312, 84028.187500, 84023.023438, 84021.367188, 84027.875000, 84039.671875, 84049.437500, 84058.406250, 84072.617188, 84088.703125, 84100.382812, 84110.929688, 84126.718750, 84144.210938, 84153.484375, 84154.671875, 84160.476562, 84175.828125, 84190.664062, 84200.867188, 84212.867188, 84225.460938, 84232.093750, 84236.218750, 84246.171875, 84261.640625, 84276.421875, 84286.734375, 84287.773438, 84265.023438, 84198.359375, 84086.359375, 83965.265625, 83885.328125, 83862.835938, 83872.687500, 83886.953125, 83899.429688, 83913.867188, 83927.632812, 83933.804688, 83934.992188, 83943.203125, 83960.484375, 83974.851562, 83978.453125, 83974.335938, 83967.351562, 83958.031250, 83944.078125, 83928.976562, 83921.054688, 83917.468750, 83906.515625, 83886.679688, 83867.250000, 83855.195312, 83848.921875, 83842.546875, 83833.710938, 83825.429688, 83820.210938, 83817.093750, 83813.515625, 83806.859375, 83797.562500, 83790.781250, 83790.882812, 83794.992188, 83797.390625, 83796.007812, 83786.703125, 83759.453125, 83708.187500, 83637.375000, 83561.273438, 83501.492188, 83471.164062, 83459.773438, 83449.132812, 83436.164062, 83426.109375, 83418.062500, 83410.492188, 83408.523438, 83415.476562, 83425.781250, 83432.734375, 83436.015625, 83436.820312, 83434.632812, 83432.640625, 83435.820312, 83443.132812, 83449.296875, 83452.671875, 83457.367188, 83467.726562, 83481.726562, 83492.648438, 83497.257812, 83500.617188, 83510.742188, 83527.335938, 83541.054688, 83546.359375, 83549.093750, 83557.734375, 83573.250000, 83589.687500, 83601.781250, 83611.671875, 83623.960938, 83635.851562, 83643.218750, 83650.289062, 83662.265625, 83676.968750, 83691.929688, 83708.195312, 83720.359375, 83714.421875, 83677.726562, 83611.625000, 83535.789062, 83470.757812, 83424.570312, 83401.312500, 83401.507812, 83413.273438, 83419.148438, 83412.734375, 83402.015625, 83396.742188, 83398.921875, 83406.945312, 83420.710938, 83436.406250, 83446.273438, 83448.906250, 83448.820312, 83448.335938, 83448.132812, 83450.984375, 83457.289062, 83464.554688, 83473.968750, 83486.750000, 83500.960938, 83515.101562, 83527.085938, 83536.609375, 83546.984375, 83558.484375, 83568.976562, 83579.125000, 83590.218750, 83601.867188, 83612.054688, 83620.234375, 83631.226562, 83648.085938, 83665.468750, 83679.609375, 83693.718750, 83708.140625, 83720.914062, 83732.593750, 83732.078125, 83696.125000, 83622.492188, 83541.414062, 83482.265625, 83450.109375, 83435.882812, 83430.812500, 83434.546875, 83449.773438, 83465.531250, 83465.304688, 83453.492188, 83449.687500, 83460.625000, 83475.882812, 83484.359375, 83485.625000, 83488.140625, 83495.375000, 83500.453125, 83501.515625, 83506.468750, 83517.046875, 83528.101562, 83538.914062, 83549.843750, 83558.640625, 83566.570312, 83576.789062, 83588.593750, 83598.960938, 83605.859375, 83610.781250, 83619.148438, 83633.390625, 83648.304688, 83656.906250, 83660.617188, 83668.953125, 83682.531250, 83691.898438, 83697.578125, 83704.726562, 83700.648438, 83665.640625, 83604.984375, 83549.250000, 83520.015625, 83512.062500, 83512.429688, 83517.437500, 83527.203125, 83539.046875, 83548.273438, 83551.250000, 83551.007812, 83556.375000, 83569.453125, 83580.289062, 83580.703125, 83577.132812, 83581.734375, 83595.242188, 83607.062500, 83610.023438, 83608.500000, 83613.218750, 83629.039062, 83647.531250, 83657.664062, 83662.320312, 83670.015625, 83679.296875, 83687.585938, 83697.468750, 83707.609375, 83717.007812, 83729.875000, 83744.968750, 83756.656250, 83766.648438, 83779.640625, 83794.835938, 83806.906250, 83808.187500, 83790.843750, 83751.039062, 83694.914062, 83638.468750, 83596.421875, 83576.156250, 83576.906250, 83587.023438, 83592.531250, 83589.187500, 83581.062500, 83573.750000, 83572.375000, 83579.421875, 83589.984375, 83596.796875, 83600.515625, 83604.789062, 83609.367188, 83613.640625, 83617.414062, 83621.218750, 83625.531250, 83629.687500, 83635.703125, 83645.804688, 83656.726562, 83664.828125, 83673.000000, 83684.757812, 83696.062500, 83703.515625, 83710.804688, 83720.445312, 83731.445312, 83742.062500, 83750.000000, 83756.843750, 83766.125000, 83776.742188, 83788.828125, 83804.796875, 83821.250000, 83832.742188, 83838.171875, 83835.664062, 83816.304688, 83774.031250, 83720.765625, 83678.562500, 83657.101562, 83648.664062, 83644.125000, 83642.273438, 83642.890625, 83644.960938, 83647.781250, 83649.929688, 83655.078125, 83668.054688, 83682.820312, 83691.171875, 83694.726562, 83697.312500, 83698.390625, 83699.875000, 83706.796875, 83716.882812, 83723.968750, 83730.468750, 83739.765625, 83746.289062, 83746.906250, 83750.398438, 83764.585938, 83780.445312, 83784.195312, 83781.992188, 83790.445312, 83808.445312, 83823.164062, 83831.429688, 83836.867188, 83842.859375, 83854.710938, 83873.726562, 83890.390625, 83892.648438, 83876.531250, 83846.156250, 83808.968750, 83772.515625, 83745.062500, 83733.164062, 83735.601562, 83743.218750, 83746.875000, 83747.062500, 83749.968750, 83755.078125, 83759.289062, 83763.914062, 83768.078125, 83770.109375, 83772.835938, 83775.796875, 83774.851562, 83772.328125, 83774.429688, 83781.179688, 83788.515625, 83795.679688, 83802.445312, 83806.117188, 83810.054688, 83822.835938, 83839.554688, 83844.484375, 83838.226562, 83838.671875, 83853.617188, 83872.609375, 83885.070312, 83893.406250, 83906.289062, 83923.757812, 83934.750000, 83929.351562, 83906.335938, 83870.281250, 83827.437500, 83786.593750, 83759.015625, 83749.648438, 83751.195312, 83753.570312, 83753.406250, 83750.625000, 83746.906250, 83748.492188, 83759.140625, 83774.601562, 83788.414062, 83796.085938, 83797.203125, 83795.835938, 83795.960938, 83798.726562, 83804.296875, 83813.437500, 83825.460938, 83836.414062, 83843.859375, 83850.875000, 83860.507812, 83871.125000, 83878.898438, 83882.765625, 83887.546875, 83898.093750, 83910.382812, 83915.593750, 83914.179688, 83917.562500, 83930.414062, 83944.031250, 83952.500000, 83960.265625, 83969.382812, 83969.664062, 83948.625000, 83906.781250, 83857.289062, 83815.023438, 83787.539062, 83772.242188, 83764.421875, 83762.953125, 83764.164062, 83761.257812, 83755.085938, 83754.921875, 83764.859375, 83779.851562, 83792.992188, 83800.351562, 83803.156250, 83804.976562, 83807.445312, 83810.609375, 83813.476562, 83816.687500, 83823.585938, 83833.539062, 83841.085938, 83846.585938, 83857.398438, 83872.375000, 83882.226562, 83887.679688, 83895.578125, 83904.960938, 83913.976562, 83924.242188, 83932.937500, 83937.992188, 83944.070312, 83954.164062, 83965.445312, 83975.234375, 83985.765625, 83999.937500, 84015.367188, 84029.335938, 84041.789062, 84048.898438, 84042.085938, 84014.257812, 83967.273438, 83915.507812, 83876.007812, 83855.554688, 83850.328125, 83852.328125, 83855.406250, 83857.101562, 83856.648438, 83856.492188, 83859.492188, 83865.335938, 83876.492188, 83895.046875, 83910.546875, 83911.781250, 83907.632812, 83912.531250, 83921.046875, 83920.421875, 83917.617188, 83929.703125, 83953.515625, 83969.015625, 83968.882812, 83967.289062, 83978.195312, 83994.828125, 84002.492188, 84003.007812, 84008.890625, 84022.164062, 84033.500000, 84038.921875, 84043.945312, 84051.929688, 84061.757812, 84070.726562, 84073.398438, 84065.179688, 84042.531250, 84001.664062, 83949.757812, 83907.570312, 83888.187500, 83885.468750, 83888.484375, 83892.437500, 83894.609375, 83893.226562, 83892.195312, 83899.125000, 83913.484375, 83923.851562, 83922.945312, 83915.578125, 83911.523438, 83918.085938, 83932.992188, 83946.179688, 83953.101562, 83956.750000, 83958.445312, 83960.039062, 83965.640625, 83973.062500, 83978.601562, 83986.406250, 83998.585938, 84008.671875, 84012.867188, 84015.679688, 84022.312500, 84033.703125, 84047.804688, 84059.179688, 84063.531250, 84066.265625, 84074.617188, 84082.687500, 84075.578125, 84044.390625, 83996.179688, 83948.125000, 83909.492188, 83879.617188, 83859.312500, 83849.625000, 83847.710938, 83848.671875, 83846.929688, 83840.750000, 83835.250000, 83835.531250, 83841.289062, 83847.601562, 83849.226562, 83849.562500, 83856.359375, 83866.421875, 83870.914062, 83871.687500, 83877.664062, 83889.835938, 83900.210938, 83905.304688, 83911.640625, 83923.687500, 83937.406250, 83947.664062, 83953.218750, 83957.507812, 83966.226562, 83979.406250, 83990.328125, 83995.617188, 83999.695312, 84007.632812, 84018.593750, 84029.226562, 84039.820312, 84052.585938, 84066.625000, 84074.179688, 84062.023438, 84023.929688, 83969.726562, 83915.804688, 83872.812500, 83843.890625, 83828.093750, 83822.171875, 83820.960938, 83820.789062, 83821.406250, 83822.304688, 83823.351562, 83827.460938, 83836.867188, 83850.328125, 83863.554688, 83869.632812, 83865.398438, 83858.359375, 83858.406250, 83864.343750, 83868.000000, 83868.593750, 83874.148438, 83887.898438, 83900.406250, 83904.312500, 83907.617188, 83920.023438, 83934.859375, 83939.179688, 83935.351562, 83936.500000, 83945.015625, 83952.109375, 83954.500000, 83959.062500, 83971.265625, 83986.937500, 83999.265625, 84007.125000, 84011.898438, 84009.992188, 83990.937500, 83945.554688, 83878.460938, 83809.554688, 83758.578125, 83730.187500, 83715.367188, 83703.960938, 83694.406250, 83686.867188, 83676.039062, 83661.812500, 83652.859375, 83653.281250, 83656.265625, 83653.804688, 83646.343750, 83636.414062, 83622.437500, 83606.984375, 83596.929688, 83592.945312, 83590.421875, 83589.578125, 83595.046875, 83602.781250, 83603.140625, 83599.664062, 83603.125000, 83610.859375, 83614.859375, 83617.437500, 83623.273438, 83632.593750, 83644.132812, 83654.343750, 83661.500000, 83668.218750, 83675.554688, 83677.078125, 83659.414062, 83615.296875, 83554.164062, 83493.765625, 83449.296875, 83426.320312, 83415.781250, 83405.390625, 83392.820312, 83379.734375, 83370.820312, 83375.398438, 83391.476562, 83405.335938, 83412.867188, 83419.539062, 83424.671875, 83424.843750, 83424.265625, 83429.656250, 83440.781250, 83451.445312, 83458.828125, 83465.992188, 83475.695312, 83491.148438, 83511.640625, 83527.218750, 83535.468750, 83547.476562, 83566.937500, 83586.085938, 83599.351562, 83607.453125, 83615.843750, 83629.140625, 83645.171875, 83660.742188, 83675.734375, 83687.437500, 83694.867188, 83697.984375, 83682.500000, 83634.609375, 83569.234375, 83513.078125, 83473.242188, 83444.585938, 83428.562500, 83426.445312, 83430.796875, 83432.304688, 83425.585938, 83415.695312, 83415.492188, 83427.734375, 83443.351562, 83457.195312, 83470.328125, 83481.046875, 83486.179688, 83488.250000, 83492.390625, 83500.593750, 83512.945312, 83528.140625, 83542.515625, 83554.031250, 83565.093750, 83578.843750, 83595.140625, 83610.445312, 83621.320312, 83628.937500, 83639.476562, 83655.851562, 83672.679688, 83686.109375, 83700.234375, 83719.820312, 83741.648438, 83757.640625, 83767.390625, 83777.976562, 83791.726562, 83804.125000, 83811.812500, 83817.046875, 83817.687500, 83797.390625, 83744.085938, 83673.671875, 83616.125000, 83583.617188, 83567.765625, 83560.289062, 83558.539062, 83558.203125, 83554.562500, 83545.742188, 83536.132812, 83537.140625, 83554.734375, 83578.507812]
vals = cheby_filter(orig)
vals_x = np.arange(len(vals))


peaks = q_ppg(vals)
print(peaks)

fig, axs = plt.subplots(2)
print(orig1)
print(vals)
fr = 200
to = 600
axs[0].plot(vals_x[fr:to], orig1[fr:to])
axs[1].plot(vals_x[fr:to], vals[fr:to])
plt.show()
