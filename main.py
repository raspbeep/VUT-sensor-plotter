import copy

from matplotlib import pyplot as plt
import numpy as np
from convolution import convolve

times = []

original = [42581.000000, 42576.000000, 42576.000000, 42574.000000, 42570.000000, 42577.000000, 42577.000000, 42584.000000, 42603.000000, 42632.000000, 42652.000000, 42640.000000, 42620.000000, 42608.000000, 42601.000000, 42583.000000, 42593.000000, 42596.000000, 42593.000000, 42573.000000, 42569.000000, 42562.000000, 42547.000000, 42539.000000, 42542.000000, 42535.000000, 42538.000000, 42531.000000, 42534.000000, 42526.000000, 42544.000000, 42581.000000, 42586.000000, 42560.000000, 42544.000000, 42543.000000, 42538.000000, 42543.000000, 42546.000000, 42549.000000, 42537.000000, 42541.000000, 42529.000000, 42542.000000, 42540.000000, 42540.000000, 42549.000000, 42551.000000, 42554.000000, 42550.000000, 42556.000000, 42563.000000, 42585.000000, 42611.000000, 42598.000000, 42579.000000, 42571.000000, 42574.000000, 42575.000000, 42572.000000, 42574.000000, 42574.000000, 42565.000000, 42565.000000, 42572.000000, 42572.000000, 42580.000000, 42581.000000, 42574.000000, 42574.000000, 42578.000000, 42596.000000, 42628.000000, 42634.000000, 42617.000000, 42603.000000, 42586.000000, 42589.000000, 42595.000000, 42595.000000, 42592.000000, 42589.000000, 42585.000000, 42581.000000, 42591.000000, 42588.000000, 42586.000000, 42585.000000, 42594.000000, 42597.000000, 42607.000000, 42641.000000, 42639.000000, 42612.000000, 42605.000000, 42605.000000, 42602.000000, 42607.000000, 42610.000000, 42615.000000, 42594.000000, 42600.000000, 42594.000000, 42599.000000, 42603.000000, 42595.000000, 42602.000000, 42602.000000, 42601.000000, 42612.000000, 42639.000000, 42665.000000, 42638.000000, 42622.000000, 42618.000000, 42616.000000, 42613.000000, 42610.000000, 42619.000000, 42604.000000, 42604.000000, 42601.000000, 42598.000000, 42610.000000, 42614.000000, 42611.000000, 42607.000000, 42608.000000, 42616.000000, 42631.000000, 42650.000000, 42677.000000, 42651.000000, 42638.000000, 42627.000000, 42627.000000, 42628.000000, 42631.000000, 42630.000000, 42629.000000, 42624.000000, 42622.000000, 42629.000000, 42625.000000, 42624.000000, 42617.000000, 42623.000000, 42617.000000, 42625.000000, 42631.000000, 42635.000000, 42668.000000, 42698.000000, 42687.000000, 42664.000000, 42653.000000, 42650.000000, 42651.000000, 42639.000000, 42654.000000, 42654.000000, 42655.000000, 42646.000000, 42642.000000, 42637.000000, 42642.000000, 42647.000000, 42649.000000, 42651.000000, 42655.000000, 42658.000000, 42662.000000, 42677.000000, 42711.000000, 42728.000000, 42705.000000, 42687.000000, 42677.000000, 42676.000000, 42669.000000, 42666.000000, 42671.000000, 42662.000000, 42664.000000, 42657.000000, 42662.000000, 42665.000000, 42670.000000, 42666.000000, 42665.000000, 42669.000000, 42671.000000, 42663.000000, 42671.000000, 42686.000000, 42727.000000, 42736.000000, 42719.000000, 42700.000000, 42705.000000, 42699.000000, 42694.000000, 42690.000000, 42696.000000, 42690.000000, 42688.000000, 42688.000000, 42699.000000, 42690.000000, 42695.000000, 42689.000000, 42697.000000, 42703.000000, 42707.000000, 42698.000000, 42703.000000, 42713.000000, 42749.000000, 42765.000000, 42743.000000, 42721.000000, 42718.000000, 42716.000000, 42706.000000, 42706.000000, 42714.000000, 42707.000000, 42699.000000, 42700.000000, 42699.000000, 42700.000000, 42700.000000, 42709.000000, 42713.000000, 42703.000000, 42715.000000, 42718.000000, 42726.000000, 42735.000000, 42777.000000, 42779.000000, 42752.000000, 42741.000000, 42736.000000, 42735.000000, 42730.000000, 42726.000000, 42730.000000, 42715.000000, 42717.000000, 42701.000000, 42712.000000, 42715.000000, 42713.000000, 42721.000000, 42715.000000, 42726.000000, 42732.000000, 42730.000000, 42738.000000, 42739.000000, 42778.000000, 42783.000000, 42773.000000, 42749.000000, 42742.000000, 42740.000000, 42737.000000, 42737.000000, 42738.000000, 42733.000000, 42724.000000, 42712.000000, 42712.000000, 42716.000000, 42715.000000, 42717.000000, 42720.000000, 42719.000000, 42720.000000, 42704.000000, 42720.000000, 42731.000000, 42761.000000, 42776.000000, 42749.000000, 42730.000000, 42725.000000, 42718.000000, 42717.000000, 42719.000000, 42720.000000, 42715.000000, 42711.000000, 42710.000000, 42701.000000, 42694.000000, 42708.000000, 42709.000000, 42704.000000, 42704.000000, 42704.000000, 42708.000000, 42715.000000, 42750.000000, 42773.000000, 42759.000000, 42730.000000, 42723.000000, 42728.000000, 42718.000000, 42719.000000, 42728.000000, 42723.000000, 42709.000000, 42709.000000, 42712.000000, 42707.000000, 42704.000000, 42716.000000, 42713.000000, 42702.000000, 42716.000000, 42714.000000, 42738.000000, 42768.000000, 42759.000000, 42739.000000, 42733.000000, 42735.000000, 42731.000000, 42736.000000, 42737.000000, 42729.000000, 42730.000000, 42717.000000, 42715.000000, 42712.000000, 42714.000000, 42721.000000, 42717.000000, 42714.000000, 42717.000000, 42734.000000, 42779.000000, 42781.000000, 42757.000000, 42740.000000, 42740.000000, 42729.000000, 42726.000000, 42724.000000, 42727.000000, 42717.000000, 42689.000000, 42690.000000, 42690.000000, 42701.000000, 42695.000000, 42700.000000, 42701.000000, 42689.000000, 42696.000000, 42692.000000, 42724.000000, 42761.000000, 42761.000000, 42737.000000, 42721.000000, 42724.000000, 42697.000000, 42685.000000, 42690.000000, 42694.000000, 42690.000000, 42693.000000, 42683.000000, 42691.000000, 42683.000000, 42689.000000, 42687.000000, 42688.000000, 42690.000000, 42692.000000, 42686.000000, 42696.000000, 42730.000000, 42760.000000, 42736.000000, 42729.000000, 42717.000000, 42713.000000, 42703.000000, 42710.000000, 42714.000000, 42701.000000, 42691.000000, 42686.000000, 42689.000000, 42691.000000, 42687.000000, 42693.000000, 42692.000000, 42694.000000, 42687.000000, 42693.000000, 42694.000000, 42729.000000, 42762.000000, 42751.000000, 42733.000000, 42725.000000, 42720.000000, 42712.000000, 42716.000000, 42722.000000, 42717.000000, 42713.000000, 42701.000000, 42697.000000, 42709.000000, 42708.000000, 42713.000000, 42717.000000, 42706.000000, 42706.000000, 42716.000000, 42720.000000, 42752.000000, 42791.000000, 42780.000000, 42756.000000, 42749.000000, 42752.000000, 42735.000000, 42730.000000, 42741.000000, 42735.000000, 42724.000000, 42720.000000, 42713.000000, 42721.000000, 42713.000000, 42720.000000, 42724.000000, 42726.000000, 42730.000000, 42729.000000, 42732.000000, 42730.000000, 42744.000000, 42764.000000, 42810.000000, 42797.000000, 42778.000000, 42764.000000, 42761.000000, 42756.000000, 42747.000000, 42750.000000, 42743.000000, 42739.000000, 42739.000000, 42741.000000, 42732.000000, 42735.000000, 42735.000000, 42735.000000, 42733.000000, 42739.000000, 42735.000000, 42739.000000, 42749.000000, 42746.000000, 42798.000000, 42810.000000, 42780.000000, 42767.000000, 42766.000000, 42764.000000, 42753.000000, 42756.000000, 42751.000000, 42740.000000, 42744.000000, 42738.000000, 42737.000000, 42742.000000, 42745.000000, 42742.000000, 42750.000000, 42756.000000, 42756.000000, 42752.000000, 42769.000000, 42805.000000, 42833.000000, 42820.000000, 42794.000000, 42795.000000, 42783.000000, 42777.000000, 42772.000000, 42775.000000, 42768.000000, 42773.000000, 42770.000000, 42767.000000, 42758.000000, 42765.000000, 42766.000000, 42765.000000, 42767.000000, 42773.000000, 42774.000000, 42772.000000, 42779.000000, 42801.000000, 42861.000000, 42870.000000, 42840.000000, 42854.000000, 42877.000000, 42876.000000, 42871.000000, 42874.000000, 42878.000000, 42876.000000, 42862.000000, 42874.000000, 42867.000000, 42872.000000, 42876.000000, 42877.000000, 42876.000000, 42868.000000, 42874.000000, 42887.000000, 42881.000000, 42882.000000, 42901.000000, 42916.000000, 42945.000000, 42925.000000, 42903.000000, 42893.000000, 42894.000000, 42885.000000, 42882.000000, 42881.000000]
filtered = [-33.464444, -42.131111, -48.464444, -50.797778, -52.797778, -52.464444, -51.464444, -46.797778, -38.131111, -19.797778, 2.868889, 15.202222, 11.202222, -3.464444, -16.464444, -28.797778, -33.797778, -35.464444, -32.131111, -38.797778, -47.797778, -58.131111, -66.797778, -76.797778, -83.464444, -87.464444, -87.797778, -91.464444, -91.797778, -95.797778, -91.464444, -75.797778, -55.797778, -50.464444, -62.797778, -77.131111, -84.464444, -84.797778, -83.797778, -80.131111, -82.131111, -83.797778, -90.464444, -88.797778, -89.131111, -85.464444, -83.131111, -79.464444, -74.797778, -74.464444, -72.797778, -69.797778, -58.131111, -39.797778, -28.131111, -30.131111, -43.464444, -51.464444, -52.797778, -52.464444, -52.464444, -52.797778, -55.131111, -58.131111, -58.797778, -56.464444, -51.464444, -48.464444, -47.797778, -49.797778, -50.797778, -43.464444, -25.464444, -6.797778, 0.202222, -8.131111, -24.131111, -33.464444, -36.131111, -33.131111, -32.131111, -34.131111, -37.464444, -41.131111, -40.464444, -39.464444, -37.797778, -39.797778, -37.797778, -34.131111, -26.797778, -11.131111, 2.868889, 4.535556, -7.464444, -18.797778, -22.131111, -21.464444, -19.797778, -15.464444, -19.797778, -23.131111, -30.131111, -28.464444, -27.464444, -27.131111, -26.131111, -26.464444, -24.464444, -21.131111, -8.797778, 12.535556, 21.202222, 15.535556, -0.131111, -7.464444, -10.464444, -13.131111, -12.131111, -15.131111, -17.131111, -23.131111, -25.131111, -23.131111, -18.797778, -14.464444, -15.464444, -17.464444, -15.797778, -7.797778, 6.202222, 26.535556, 33.202222, 29.202222, 12.535556, 4.535556, 1.202222, 2.535556, 3.535556, 3.868889, 1.535556, -1.131111, -1.131111, -0.797778, -0.131111, -4.131111, -4.797778, -7.131111, -4.464444, -1.797778, 4.202222, 18.535556, 40.868889, 58.202222, 56.868889, 41.868889, 29.535556, 25.202222, 20.535556, 21.868889, 22.868889, 28.202222, 25.535556, 21.535556, 15.535556, 14.202222, 15.868889, 19.868889, 22.868889, 25.535556, 28.535556, 32.202222, 39.535556, 57.202222, 79.202222, 88.535556, 80.535556, 63.535556, 53.868889, 47.868889, 44.202222, 42.535556, 40.202222, 39.535556, 34.868889, 34.868889, 35.202222, 39.535556, 40.868889, 40.868889, 40.535556, 42.202222, 41.535556, 42.202222, 47.202222, 68.535556, 90.202222, 101.202222, 92.202222, 81.868889, 75.202222, 73.202222, 68.202222, 67.202222, 65.868889, 65.202222, 62.535556, 65.535556, 66.202222, 68.535556, 65.202222, 67.535556, 70.202222, 76.202222, 76.535556, 76.535556, 78.535556, 95.535556, 116.202222, 126.202222, 116.868889, 101.202222, 92.202222, 87.202222, 83.202222, 82.535556, 82.868889, 80.535556, 75.868889, 73.202222, 73.535556, 73.535556, 76.868889, 81.202222, 82.202222, 84.202222, 85.868889, 93.535556, 100.202222, 119.868889, 137.535556, 143.202222, 131.202222, 116.868889, 111.202222, 107.535556, 104.202222, 102.535556, 97.535556, 94.535556, 84.868889, 83.868889, 83.202222, 87.202222, 90.202222, 90.202222, 94.535556, 98.202222, 103.202222, 107.202222, 109.535556, 125.535556, 140.535556, 151.868889, 142.202222, 128.535556, 117.535556, 113.535556, 111.868889, 111.202222, 109.868889, 105.535556, 96.868889, 89.868889, 87.202222, 88.202222, 89.868889, 91.202222, 92.535556, 93.535556, 88.202222, 88.535556, 92.202222, 111.202222, 129.868889, 135.868889, 125.535556, 108.535556, 98.202222, 93.868889, 91.868889, 92.535556, 91.868889, 89.202222, 85.868889, 81.202222, 75.535556, 74.868889, 77.535556, 80.868889, 79.535556, 77.868889, 79.202222, 82.868889, 98.202222, 119.868889, 134.535556, 127.868889, 111.202222, 100.868889, 96.868889, 95.535556, 95.535556, 97.202222, 93.868889, 87.535556, 83.868889, 83.202222, 81.535556, 82.868889, 84.868889, 84.202222, 84.202222, 84.535556, 96.535556, 113.868889, 128.868889, 129.202222, 117.535556, 109.535556, 106.868889, 107.868889, 108.535556, 107.868889, 105.868889, 99.202222, 94.535556, 88.535556, 87.535556, 89.535556, 91.202222, 91.202222, 89.868889, 95.535556, 117.202222, 138.535556, 146.202222, 133.202222, 119.535556, 110.202222, 105.535556, 100.202222, 99.535556, 96.535556, 84.868889, 72.535556, 63.535556, 67.535556, 69.202222, 72.535556, 72.535556, 70.535556, 69.202222, 66.202222, 77.868889, 99.535556, 122.535556, 126.868889, 113.535556, 101.202222, 87.868889, 75.868889, 64.535556, 63.535556, 65.202222, 66.202222, 62.535556, 62.868889, 59.535556, 61.535556, 60.202222, 61.868889, 62.202222, 63.868889, 63.202222, 65.202222, 77.868889, 102.535556, 115.868889, 115.535556, 101.202222, 93.535556, 84.868889, 82.535556, 82.868889, 82.202222, 75.868889, 66.535556, 62.535556, 62.535556, 62.868889, 64.202222, 64.535556, 66.868889, 64.868889, 65.202222, 65.202222, 79.202222, 102.202222, 121.202222, 122.535556, 110.202222, 99.868889, 92.868889, 89.868889, 90.535556, 92.202222, 91.202222, 84.202222, 77.535556, 76.202222, 78.535556, 83.868889, 86.535556, 85.868889, 83.535556, 83.202222, 87.868889, 103.202222, 128.202222, 148.202222, 149.535556, 135.535556, 126.202222, 119.202222, 112.868889, 109.202222, 109.202222, 107.202222, 100.202222, 92.868889, 91.868889, 89.535556, 91.868889, 92.868889, 97.202222, 100.535556, 102.202222, 104.202222, 104.202222, 109.202222, 119.868889, 146.535556, 164.202222, 168.868889, 153.535556, 141.535556, 134.202222, 128.535556, 124.868889, 120.535556, 117.868889, 114.202222, 113.535556, 111.202222, 109.868889, 107.868889, 108.868889, 108.202222, 109.535556, 109.535556, 111.535556, 114.868889, 118.535556, 138.202222, 158.535556, 169.868889, 159.535556, 144.868889, 139.535556, 134.868889, 131.535556, 127.202222, 122.868889, 118.868889, 114.535556, 113.535556, 112.868889, 115.202222, 116.868889, 119.535556, 123.202222, 127.868889, 128.535556, 132.868889, 149.202222, 176.202222, 193.202222, 189.535556, 176.868889, 164.535556, 158.868889, 151.202222, 148.535556, 145.535556, 145.868889, 144.202222, 143.868889, 138.868889, 137.202222, 136.868889, 139.202222, 139.868889, 142.202222, 145.202222, 146.868889, 148.868889, 157.868889, 187.535556, 217.868889, 230.868889, 228.535556, 230.868889, 242.868889, 248.535556, 247.535556, 248.202222, 249.868889, 245.868889, 244.535556, 241.535556, 244.868889, 245.535556, 248.868889, 250.202222, 247.535556, 246.535556, 250.202222, 254.535556, 257.202222, 261.868889, 273.535556, 294.535556, 302.535556, 298.202222, 280.868889, 270.535556, 264.535556, 260.868889, 256.535556]
filtered_again = [-73.289638, -96.379443, -88.211041, -60.076725, -30.538575, -14.787115, -17.338991, -31.373409, -44.155195, -44.925232, -30.817727, -7.922592, 12.540244, 20.438724, 11.882214, -9.234946, -33.742931, -52.106746, -59.050675, -55.633193, -48.010922, -43.841440, -48.325252, -61.838834, -80.119329, -96.625586, -105.710637, -105.030314, -96.179451, -83.513154, -71.957781, -64.957467, -63.450252, -66.135622, -70.646308, -74.887024, -77.871511, -79.772011, -81.348908, -83.212855, -85.370149, -87.261239, -88.185488, -87.792825, -86.317227, -84.408602, -82.671620, -81.197798, -79.386810, -76.195281, -70.714854, -62.792400, -53.361826, -44.282168, -37.709251, -35.255935, -37.309549, -42.819780, -49.669732, -55.487109, -58.556132, -58.441875, -56.059845, -53.162882, -51.471066, -51.827853, -53.757834, -55.629977, -55.367584, -51.405146, -43.477615, -32.890862, -22.138425, -14.007723, -10.539271, -12.269170, -18.067952, -25.637040, -32.446006, -36.709896, -37.995845, -37.215815, -36.033339, -35.967372, -37.603830, -40.270393, -42.318799, -41.886028, -37.792492, -30.174772, -20.567332, -11.388372, -5.042856, -3.018467, -5.349568, -10.663959, -16.779631, -21.591265, -23.874173, -23.679926, -22.177920, -21.031000, -21.582465, -24.200544, -28.051968, -31.394389, -32.265724, -29.292102, -22.294125, -12.455073, -1.986617, 6.581494, 11.224482, 11.060683, 6.583691, -0.578289, -8.270241, -14.552516, -18.306873, -19.497468, -19.012694, -18.170418, -18.090149, -19.178411, -20.924613, -22.084191, -21.178920, -17.124836, -9.749139, 0.004358, 10.270517, 18.804014, 23.685725, 23.950619, 19.915591, 13.085935, 5.663593, -0.180234, -3.019811, -2.627263, 0.000716, 3.058694, 4.650190, 3.553429, -0.244786, -5.452825, -9.868985, -11.142404, -7.635971, 0.919850, 13.226763, 26.757345, 38.523837, 46.011145, 47.948068, 44.650906, 37.830927, 29.951554, 23.378754, 19.631219, 18.985434, 20.549334, 22.744158, 23.993427, 23.359601, 20.907231, 17.683848, 15.349385, 15.600105, 19.587496, 27.516014, 38.531301, 50.913770, 62.504510, 71.235224, 75.620230, 75.091610, 70.105613, 62.005098, 52.677296, 44.090435, 37.820515, 34.685672, 34.585480, 36.595916, 39.303844, 41.293119, 41.639718, 40.257055, 37.967492, 36.257454, 36.778675, 40.751331, 48.470412, 59.093532, 70.799481, 81.281135, 88.418365, 90.910148, 88.655690, 82.759205, 75.161435, 68.026576, 63.091756, 61.191489, 62.102868, 64.744760, 67.646327, 69.516085, 69.717819, 68.498218, 66.897260, 66.376803, 68.292676, 73.384239, 81.449199, 91.313256, 101.111581, 108.800285, 112.741477, 112.179083, 107.454381, 99.891509, 91.389059, 83.849757, 78.633577, 76.211459, 76.128559, 77.280247, 78.397248, 78.565440, 77.596017, 76.116203, 75.350193, 76.668944, 81.067490, 88.751862, 98.977618, 110.194084, 120.444968, 127.893248, 131.303505, 130.336941, 125.581858, 118.329452, 110.181194, 102.616667, 96.649680, 92.661591, 90.440038, 89.389031, 88.830122, 88.294571, 87.715817, 87.465290, 88.223097, 90.725326, 95.468069, 102.463585, 111.130485, 120.360304, 128.748488, 134.926000, 137.895518, 137.274459, 133.376066, 127.109107, 119.729546, 112.517465, 106.468999, 102.084400, 99.304667, 97.609653, 96.249038, 94.542071, 92.159389, 89.297295, 86.676527, 85.344190, 86.320361, 90.192081, 96.793313, 105.100250, 113.411438, 119.786034, 122.614161, 121.130050, 115.681547, 107.644315, 98.992458, 91.664365, 86.943663, 85.076765, 85.266865, 86.048348, 85.905634, 83.908981, 80.130945, 75.684736, 72.361503, 71.988760, 75.734932, 83.608851, 94.339250, 105.689563, 115.112056, 120.524935, 120.948973, 116.784526, 109.632170, 101.719462, 95.136617, 91.153897, 89.865533, 90.286071, 90.856697, 90.163231, 87.584194, 83.610941, 79.706636, 77.750995, 79.283549, 84.843335, 93.671019, 103.900350, 113.173179, 119.443127, 121.656509, 120.047965, 115.943632, 111.163503, 107.275028, 105.005479, 104.048667, 103.333027, 101.624235, 98.197706, 93.290919, 88.140850, 84.585111, 84.383133, 88.523124, 96.780730, 107.692185, 118.945334, 128.042025, 133.000342, 132.869596, 127.912300, 119.426968, 109.297864, 99.428582, 91.232381, 85.319375, 81.456020, 78.794575, 76.295796, 73.211090, 69.464440, 65.791836, 63.561312, 64.300076, 69.067640, 77.893992, 89.510563, 101.521661, 111.013046, 115.424150, 113.389444, 105.238256, 92.948174, 79.541537, 68.123993, 60.904643, 58.549666, 60.097714, 63.453539, 66.260225, 66.815058, 64.690281, 60.844487, 57.209357, 55.929719, 58.549644, 65.436629, 75.629929, 87.136776, 97.545893, 104.735033, 107.442306, 105.539984, 99.960151, 92.331759, 84.465029, 77.845428, 73.278137, 70.768848, 69.656519, 68.945483, 67.731489, 65.589599, 62.798305, 60.316344, 59.500259, 61.635359, 67.424798, 76.613765, 87.899511, 99.193239, 108.179804, 113.006766, 112.870483, 108.284570, 100.917039, 93.035201, 86.746246, 83.307121, 82.761218, 84.041671, 85.503257, 85.675797, 83.940380, 80.855596, 77.997157, 77.367593, 80.604810, 88.298589, 99.679662, 112.796509, 125.103839, 134.233520, 138.664378, 138.068026, 133.249998, 125.763011, 117.375442, 109.595780, 103.389456, 99.120478, 96.660886, 95.573605, 95.292953, 95.274951, 95.127960, 94.736868, 94.362976, 94.664594, 96.575694, 101.021245, 108.526956, 118.858874, 130.857947, 142.588036, 151.801984, 156.594711, 156.016652, 150.413566, 141.349922, 131.128100, 122.070409, 115.820525, 112.909291, 112.724259, 113.869061, 114.760285, 114.237662, 111.978429, 108.593198, 105.398338, 103.963420, 105.589830, 110.878764, 119.504444, 130.243076, 141.240946, 150.450083, 156.123878, 157.250380, 153.810558, 146.784540, 137.889545, 129.108593, 122.139210, 117.930680, 116.465627, 116.871514, 117.836916, 118.193142, 117.448677, 116.065872, 115.353973, 116.993623, 122.353875, 131.854954, 144.628135, 158.623426, 171.151684, 179.683108, 182.623530, 179.794195, 172.448710, 162.830396, 153.438022, 146.265003, 142.272052, 141.253042, 142.102103, 143.347863, 143.741139, 142.689447, 140.413436, 137.816556, 136.160450, 136.687263, 140.315359, 147.474377, 158.074464, 171.558223, 186.980607, 203.094914, 218.465140, 231.643814, 241.431427, 247.175525, 249.006441, 247.883948, 245.372712, 243.169381, 242.528356, 243.814052, 246.391897, 248.946827, 250.129999, 249.266609, 246.797806, 244.222506, 243.522335, 246.299739, 253.014326, 262.679947, 273.182541, 282.086665, 287.560177, 288.985982, 286.985650, 282.878147, 277.885438, 272.521696, 266.493667, 259.150781]
# original = [44194.000000, 44265.000000, 44331.000000, 44353.000000, 44369.000000, 44379.000000, 44378.000000, 44375.000000, 44357.000000, 44350.000000, 44359.000000, 44363.000000, 44365.000000, 44349.000000, 44374.000000, 44407.000000, 44427.000000, 44436.000000, 44448.000000, 44454.000000, 44447.000000, 44442.000000, 44438.000000, 44444.000000, 44452.000000, 44440.000000, 44432.000000, 44442.000000, 44442.000000, 44443.000000, 44443.000000, 44427.000000, 44434.000000, 44451.000000, 44451.000000, 44443.000000, 44433.000000, 44464.000000, 44476.000000, 44463.000000, 44460.000000, 44448.000000, 44450.000000, 44455.000000, 44451.000000, 44456.000000, 44452.000000, 44466.000000, 44442.000000, 44427.000000, 44439.000000, 44442.000000, 44434.000000, 44432.000000, 44435.000000, 44435.000000, 44430.000000, 44421.000000, 44422.000000, 44420.000000, 44424.000000, 44422.000000, 44423.000000, 44429.000000, 44432.000000, 44437.000000, 44439.000000, 44389.000000, 44370.000000, 44375.000000, 44394.000000, 44384.000000, 44386.000000, 44397.000000, 44399.000000, 44401.000000, 44394.000000, 44394.000000, 44401.000000, 44401.000000, 44386.000000, 44395.000000, 44396.000000, 44405.000000, 44401.000000, 44399.000000, 44388.000000, 44357.000000, 44354.000000, 44375.000000, 44369.000000, 44377.000000, 44371.000000, 44382.000000, 44382.000000, 44371.000000, 44364.000000, 44383.000000, 44387.000000, 44392.000000, 44395.000000, 44399.000000, 44396.000000, 44402.000000, 44408.000000, 44416.000000, 44409.000000, 44379.000000, 44363.000000, 44382.000000, 44397.000000, 44398.000000, 44407.000000, 44411.000000, 44421.000000, 44426.000000, 44432.000000, 44430.000000, 44423.000000, 44434.000000, 44431.000000, 44447.000000, 44449.000000, 44445.000000, 44460.000000, 44476.000000, 44481.000000, 44475.000000, 44450.000000, 44441.000000, 44462.000000, 44469.000000, 44475.000000, 44467.000000, 44484.000000, 44477.000000, 44468.000000, 44477.000000, 44478.000000, 44485.000000, 44488.000000, 44493.000000, 44497.000000, 44512.000000, 44535.000000, 44546.000000, 44533.000000, 44531.000000, 44529.000000, 44512.000000, 44500.000000, 44522.000000, 44556.000000, 44569.000000, 44536.000000, 44536.000000, 44535.000000, 44534.000000, 44526.000000, 44525.000000, 44541.000000, 44540.000000, 44545.000000, 44552.000000, 44563.000000, 44554.000000, 44566.000000, 44565.000000, 44557.000000, 44522.000000, 44521.000000, 44525.000000, 44530.000000, 44531.000000, 44540.000000, 44554.000000, 44545.000000, 44536.000000, 44519.000000, 44528.000000, 44531.000000, 44522.000000, 44533.000000, 44535.000000, 44534.000000, 44534.000000, 44538.000000, 44545.000000, 44547.000000, 44524.000000, 44512.000000, 44512.000000, 44523.000000, 44527.000000, 44520.000000, 44529.000000, 44530.000000, 44525.000000, 44529.000000, 44529.000000, 44532.000000, 44538.000000, 44535.000000, 44542.000000, 44551.000000, 44549.000000, 44550.000000, 44553.000000, 44567.000000, 44564.000000, 44537.000000, 44516.000000, 44527.000000, 44531.000000, 44536.000000, 44546.000000, 44553.000000, 44569.000000, 44564.000000, 44564.000000, 44566.000000, 44562.000000, 44565.000000, 44553.000000, 44564.000000, 44571.000000, 44564.000000, 44562.000000, 44555.000000, 44535.000000, 44513.000000, 44489.000000, 44497.000000, 44487.000000, 44485.000000, 44492.000000, 44504.000000, 44499.000000, 44496.000000, 44509.000000, 44495.000000, 44504.000000, 44505.000000, 44503.000000, 44519.000000, 44525.000000, 44515.000000, 44530.000000, 44515.000000, 44497.000000, 44493.000000, 44486.000000, 44486.000000, 44495.000000, 44485.000000, 44498.000000, 44500.000000, 44498.000000, 44509.000000, 44505.000000, 44512.000000, 44522.000000, 44529.000000, 44513.000000, 44526.000000, 44532.000000, 44524.000000, 44503.000000, 44487.000000, 44497.000000, 44491.000000, 44504.000000, 44513.000000, 44510.000000, 44519.000000, 44515.000000, 44526.000000, 44527.000000, 44523.000000, 44519.000000, 44523.000000, 44521.000000, 44525.000000, 44534.000000, 44538.000000, 44523.000000, 44481.000000, 44473.000000, 44477.000000, 44493.000000, 44503.000000, 44504.000000, 44515.000000, 44516.000000, 44506.000000, 44497.000000, 44491.000000, 44483.000000, 44472.000000, 44477.000000, 44471.000000, 44475.000000, 44485.000000, 44494.000000, 44480.000000, 44474.000000, 44449.000000, 44455.000000, 44456.000000, 44453.000000, 44453.000000, 44453.000000, 44457.000000, 44461.000000, 44471.000000, 44461.000000, 44447.000000, 44446.000000, 44446.000000, 44457.000000, 44469.000000, 44470.000000, 44474.000000, 44481.000000, 44468.000000, 44455.000000, 44428.000000, 44421.000000, 44428.000000, 44415.000000, 44430.000000, 44427.000000, 44441.000000, 44435.000000, 44443.000000, 44439.000000, 44445.000000, 44439.000000, 44439.000000, 44436.000000, 44441.000000, 44444.000000, 44451.000000, 44463.000000, 44461.000000, 44454.000000, 44423.000000, 44431.000000, 44451.000000, 44440.000000, 44441.000000, 44433.000000, 44455.000000, 44450.000000, 44451.000000, 44457.000000, 44462.000000, 44466.000000, 44471.000000, 44466.000000, 44462.000000, 44468.000000, 44467.000000, 44470.000000, 44477.000000, 44481.000000, 44440.000000, 44435.000000, 44450.000000, 44449.000000, 44460.000000, 44463.000000, 44471.000000, 44470.000000, 44464.000000, 44467.000000, 44487.000000, 44480.000000, 44478.000000, 44470.000000, 44471.000000, 44484.000000, 44487.000000, 44496.000000, 44492.000000, 44496.000000, 44486.000000, 44465.000000, 44445.000000, 44456.000000, 44455.000000, 44468.000000, 44467.000000, 44468.000000, 44469.000000, 44468.000000, 44475.000000, 44458.000000, 44466.000000, 44457.000000, 44459.000000, 44472.000000, 44467.000000, 44471.000000, 44472.000000, 44462.000000, 44467.000000, 44448.000000, 44421.000000, 44419.000000, 44432.000000, 44422.000000, 44427.000000, 44430.000000, 44429.000000, 44418.000000, 44422.000000, 44412.000000, 44409.000000, 44413.000000, 44411.000000, 44408.000000, 44409.000000, 44414.000000, 44413.000000, 44424.000000, 44417.000000, 44396.000000, 44374.000000, 44392.000000, 44391.000000, 44399.000000, 44403.000000, 44413.000000, 44413.000000, 44413.000000, 44409.000000, 44401.000000, 44407.000000, 44410.000000, 44412.000000, 44422.000000, 44411.000000, 44421.000000, 44431.000000, 44435.000000, 44423.000000, 44400.000000, 44399.000000, 44405.000000, 44405.000000, 44407.000000, 44419.000000, 44424.000000, 44417.000000, 44417.000000, 44419.000000, 44423.000000, 44435.000000, 44440.000000, 44440.000000, 44443.000000, 44441.000000, 44452.000000, 44441.000000, 44436.000000, 44402.000000, 44398.000000, 44408.000000, 44411.000000, 44401.000000, 44408.000000, 44409.000000, 44413.000000, 44411.000000, 44406.000000, 44405.000000, 44403.000000, 44403.000000, 44397.000000, 44400.000000, 44405.000000, 44404.000000, 44404.000000, 44406.000000, 44400.000000, 44378.000000, 44373.000000, 44376.000000, 44376.000000, 44367.000000, 44367.000000, 44379.000000, 44371.000000, 44371.000000, 44372.000000, 44371.000000, 44373.000000, 44359.000000, 44362.000000, 44364.000000, 44366.000000, 44367.000000, 44374.000000, 44363.000000, 44341.000000, 44326.000000, 44348.000000, 44353.000000, 44337.000000, 44351.000000, 44359.000000, 44347.000000, 44345.000000, 44348.000000, 44349.000000, 44348.000000, 44354.000000, 44351.000000, 44352.000000, 44359.000000, 44369.000000, 44374.000000, 44378.000000, 44365.000000, 44341.000000, 44349.000000, 44353.000000, 44354.000000, 44363.000000, 44358.000000, 44376.000000, 44371.000000, 44374.000000, 44380.000000, 44384.000000, 44382.000000, 44387.000000, 44388.000000, 44397.000000, 44378.000000, 44397.000000, 44396.000000, 44410.000000, 44402.000000, 44371.000000, 44370.000000, 44383.000000, 44375.000000, 44371.000000, 44386.000000, 44387.000000, 44391.000000, 44382.000000, 44387.000000, 44395.000000, 44399.000000, 44389.000000, 44393.000000, 44396.000000, 44401.000000, 44406.000000, 44415.000000, 44415.000000, 44402.000000, 44382.000000, 44360.000000, 44371.000000, 44379.000000, 44375.000000, 44363.000000, 44373.000000, 44368.000000, 44369.000000, 44369.000000, 44363.000000, 44366.000000, 44365.000000, 44367.000000, 44369.000000, 44363.000000, 44365.000000, 44363.000000, 44367.000000, 44359.000000, 44342.000000, 44345.000000, 44354.000000, 44347.000000, 44344.000000, 44362.000000, 44373.000000, 44359.000000, 44368.000000, 44366.000000, 44356.000000, 44353.000000, 44353.000000, 44347.000000, 44336.000000]
# filtered = [43946.726468, 44014.305324, 44193.723912, 44400.738322, 44544.384499, 44572.508752, 44492.696622, 44361.339589, 44250.296792, 44210.469122, 44250.590383, 44339.577128, 44427.997238, 44475.352602, 44468.819741, 44425.336395, 44378.368624, 44358.188508, 44376.544345, 44422.910480, 44472.683202, 44501.587459, 44498.155105, 44468.158629, 44429.740845, 44402.856323, 44399.071906, 44416.844095, 44443.992104, 44465.239108, 44470.394030, 44458.959257, 44439.260000, 44423.180867, 44419.680811, 44430.501405, 44449.984670, 44468.633532, 44478.214629, 44475.681744, 44464.094069, 44450.405949, 44441.574324, 44441.103822, 44447.697145, 44456.451178, 44461.730369, 44460.111421, 44451.926348, 44440.774594, 44431.439947, 44427.392466, 44429.150500, 44434.243070, 44438.668427, 44439.025022, 44434.227691, 44425.997663, 44417.952491, 44413.793230, 44415.478698, 44422.234490, 44430.822051, 44436.909201, 44436.907900, 44429.475675, 44416.062182, 44400.315560, 44386.643458, 44378.548955, 44377.411828, 44382.162219, 44389.908902, 44397.203735, 44401.398150, 44401.553306, 44398.582910, 44394.635745, 44392.026602, 44392.183068, 44395.038228, 44399.092880, 44402.087238, 44401.978461, 44397.811187, 44390.130420, 44380.785740, 44372.226392, 44366.585657, 44364.923021, 44366.913048, 44371.079691, 44375.455908, 44378.388891, 44379.169935, 44378.253986, 44377.004899, 44377.087192, 44379.752057, 44385.291585, 44392.859159, 44400.712137, 44406.781563, 44409.366092, 44407.715415, 44402.315017, 44394.786352, 44387.438000, 44382.606860, 44381.986787, 44386.142810, 44394.354760, 44404.840056, 44415.295604, 44423.601864, 44428.476021, 44429.866015, 44428.947871, 44427.710572, 44428.250859, 44432.009116, 44439.214551, 44448.750921, 44458.514266, 44466.155177, 44469.945531, 44469.445369, 44465.703345, 44460.891564, 44457.494197, 44457.354087, 44460.954530, 44467.236321, 44474.044945, 44479.046962, 44480.752065, 44479.216553, 44476.117938, 44474.140392, 44475.897134, 44482.819110, 44494.470457, 44508.590468, 44521.871110, 44531.176907, 44534.726699, 44532.764436, 44527.447678, 44521.995784, 44519.435921, 44521.442969, 44527.726577, 44536.196015, 44543.824211, 44547.862161, 44546.928605, 44541.561074, 44534.031326, 44527.509940, 44524.902781, 44527.790071, 44535.846020, 44546.932318, 44557.815982, 44565.248970, 44567.033924, 44562.719048, 44553.701678, 44542.723936, 44532.945701, 44526.914941, 44525.780888, 44529.005535, 44534.654288, 44540.147040, 44543.194671, 44542.587846, 44538.565759, 44532.649982, 44527.024997, 44523.708484, 44523.821618, 44527.218767, 44532.590691, 44537.975113, 44541.464283, 44541.844144, 44538.947835, 44533.629702, 44527.409673, 44521.944919, 44518.521592, 44517.722983, 44519.348617, 44522.570716, 44526.250877, 44529.313129, 44531.073568, 44531.447198, 44530.979489, 44530.682531, 44531.698574, 44534.867466, 44540.326130, 44547.292510, 44554.157617, 44558.918605, 44559.854372, 44556.222634, 44548.703255, 44539.367673, 44531.115201, 44526.729964, 44527.889411, 44534.512771, 44544.735152, 44555.558228, 44563.951961, 44567.980951, 44567.497224, 44564.102859, 44560.382167, 44558.711947, 44560.146948, 44563.859971, 44567.392889, 44567.636661, 44562.147079, 44550.252338, 44533.485247, 44515.146943, 44499.166196, 44488.708487, 44485.090240, 44487.424471, 44493.120181, 44499.008344, 44502.617927, 44503.078510, 44501.296786, 44499.366674, 44499.493441, 44502.906885, 44509.229453, 44516.560942, 44522.232596, 44523.902152, 44520.524585, 44512.795173, 44502.891040, 44493.634109, 44487.435921, 44485.464158, 44487.361898, 44491.604386, 44496.302310, 44500.074747, 44502.598048, 44504.594184, 44507.283093, 44511.572072, 44517.380381, 44523.441541, 44527.711188, 44528.228389, 44524.057540, 44515.878574, 44505.927356, 44497.263578, 44492.641755, 44493.449797, 44499.170410, 44507.609674, 44515.811383, 44521.275243, 44522.956395, 44521.610137, 44519.327090, 44518.461118, 44520.427661, 44524.919517, 44529.913941, 44532.500387, 44530.190743, 44522.145742, 44509.766135, 44496.353920, 44485.940632, 44481.738981, 44484.846638, 44493.740869, 44504.786748, 44513.571485, 44516.543583, 44512.315038, 44502.123726, 44489.291053, 44477.906239, 44471.263811, 44470.661042, 44475.003087, 44481.336535, 44486.070845, 44486.392794, 44481.324865, 44472.036522, 44461.318274, 44452.451970, 44447.933283, 44448.543588, 44453.118929, 44459.086023, 44463.537674, 44464.415616, 44461.333721, 44455.719281, 44450.218190, 44447.597426, 44449.575313, 44456.040574, 44464.973223, 44473.110729, 44477.115448, 44474.805303, 44465.984025, 44452.559508, 44437.908860, 44425.731549, 44418.818061, 44418.181711, 44422.851617, 44430.368369, 44437.762798, 44442.632127, 44443.915957, 44442.112488, 44438.901864, 44436.366232, 44436.130887, 44438.753319, 44443.566929, 44448.999511, 44453.209440, 44454.779989, 44453.214968, 44449.074952, 44443.737191, 44438.896913, 44436.005441, 44435.841594, 44438.345809, 44442.743516, 44447.884839, 44452.663811, 44456.368701, 44458.852254, 44460.480123, 44461.892414, 44463.673876, 44466.055935, 44468.761447, 44471.055112, 44471.992724, 44470.791332, 44467.192666, 44461.682298, 44455.464574, 44450.171251, 44447.376945, 44448.074812, 44452.298844, 44459.046185, 44466.557790, 44472.887108, 44476.570527, 44477.156795, 44475.384988, 44472.918303, 44471.706140, 44473.197880, 44477.706800, 44484.184519, 44490.521873, 44494.291188, 44493.665105, 44488.162450, 44478.921924, 44468.376419, 44459.430666, 44454.442440, 44454.392033, 44458.559004, 44464.832244, 44470.534376, 44473.441350, 44472.603167, 44468.651435, 44463.482045, 44459.445708, 44458.368620, 44460.787259, 44465.693036, 44470.882014, 44473.771840, 44472.372133, 44466.041412, 44455.749181, 44443.750549, 44432.799317, 44425.192786, 44421.997861, 44422.735783, 44425.631094, 44428.323208, 44428.771324, 44426.015243, 44420.510186, 44413.912718, 44408.400292, 44405.783663, 44406.753744, 44410.559074, 44415.250488, 44418.412789, 44418.110476, 44413.681623, 44406.061288, 44397.490699, 44390.706821, 44387.916185, 44389.951965, 44395.951163, 44403.688990, 44410.446735, 44414.072275, 44413.809292, 44410.559875, 44406.472735, 44404.024389, 44404.969609, 44409.592663, 44416.567381, 44423.482433, 44427.813131, 44427.937734, 44423.781762, 44416.832989, 44409.534497, 44404.320357, 44402.699676, 44404.762438, 44409.291614, 44414.404619, 44418.426080, 44420.606353, 44421.380046, 44422.067000, 44424.162402, 44428.537524, 44434.905840, 44441.791157, 44447.019144, 44448.534630, 44445.214651, 44437.352699, 44426.624824, 44415.553272, 44406.674229, 44401.719332, 44401.102523, 44403.878994, 44408.165467, 44411.849264, 44413.323783, 44411.995638, 44408.403122, 44403.927914, 44400.221369, 44398.558000, 44399.345356, 44401.959564, 44404.960733, 44406.610358, 44405.506773, 44401.110686, 44393.968041, 44385.543001, 44377.715306, 44372.123237, 44369.596890, 44369.897824, 44371.866363, 44373.918162, 44374.690073, 44373.571452, 44370.901306, 44367.750125, 44365.381949, 44364.632381, 44365.479197, 44367.002739, 44367.764800, 44366.448877, 44362.483627, 44356.370395, 44349.558220, 44343.904139, 44340.938774, 44341.246539, 44344.226229, 44348.338690, 44351.742258, 44353.052246, 44351.908185, 44349.113682, 44346.292589, 44345.205145, 44347.005053, 44351.738032, 44358.279847, 44364.733108, 44369.122337, 44370.117106, 44367.512702, 44362.300081, 44356.316053, 44351.616540, 44349.805042, 44351.548494, 44356.431552, 44363.174654, 44370.117795, 44375.791445, 44379.380143, 44380.931278, 44381.252261, 44381.543048, 44382.896811, 44385.844587, 44390.106632, 44394.646490, 44398.021351, 44398.915298, 44396.667572, 44391.595714, 44384.975599, 44378.660924, 44374.463236, 44373.516478, 44375.871648, 44380.491132, 44385.661098, 44389.671471, 44391.495995, 44391.193257, 44389.854528, 44389.107845, 44390.374994, 44394.189136, 44399.864939, 44405.672915, 44409.461724, 44409.483817, 44405.091387, 44397.019768, 44387.143356, 44377.803912, 44370.982043, 44367.639208, 44367.478721, 44369.196598, 44371.093800, 44371.783535, 44370.704899, 44368.250341, 44365.483533, 44363.592590, 44363.322617, 44364.625700, 44366.664464, 44368.155091, 44367.899789, 44365.290203, 44360.583877, 44354.851549, 44349.621961, 44346.362007, 44345.983649, 44348.549619, 44353.269813, 44358.772865, 44363.542741, 44366.361048, 44366.606299, 44364.324012, 44360.070692, 44354.616505, 44348.636427, 44342.512694, 44336.316921]
# filtered_again = [-28691.155128, -16745.607826, -6880.643100, -325.230194, 2662.665762, 2755.703348, 1211.619885, -623.438148, -1765.341173, -1836.911769, -1045.935428, 52.883707, 882.135028, 1106.146447, 736.549469, 62.369944, -533.668447, -770.618936, -585.213688, -127.087487, 345.933454, 608.174877, 570.279282, 302.679754, -21.460542, -225.112360, -214.457809, -13.506087, 263.544354, 480.390107, 548.467735, 464.058002, 298.673083, 153.498907, 104.970492, 169.485317, 302.295920, 426.896285, 476.665470, 426.783821, 301.963743, 159.202899, 57.075808, 28.166129, 67.551573, 140.744753, 204.590881, 229.223679, 210.315959, 167.084217, 129.074496, 119.783681, 145.556702, 194.415786, 243.971142, 273.275643, 272.337226, 245.088724, 205.427516, 169.343942, 147.547084, 142.001831, 147.284114, 155.132223, 159.289508, 158.139403, 154.243365, 151.681328, 153.102134, 158.209339, 164.313163, 168.296297, 168.599840, 165.982061, 162.659055, 160.452633, 159.158259, 156.198701, 147.865964, 131.524208, 107.568032, 80.011800, 55.274200, 39.648865, 36.635590, 45.403514, 61.127605, 77.054154, 87.345382, 89.409713, 84.690613, 77.618217, 73.269202, 74.842353, 82.097278, 91.427858, 97.487643, 95.599880, 83.868416, 64.076913, 41.023420, 20.623672, 7.628661, 3.930115, 8.135810, 16.528215, 24.926478, 30.604071, 33.418623, 35.673760, 40.793942, 51.413629, 67.743622, 86.970910, 104.016764, 113.398416, 111.453151, 97.996409, 76.684458, 53.865826, 36.328339, 28.822259, 32.359732, 43.993935, 58.179903, 69.158778, 73.368069, 70.856546, 65.095214, 61.258272, 63.711265, 73.799595, 88.918581, 103.306962, 110.267481, 104.899635, 86.200273, 57.648340, 26.027377, -1.023754, -17.723131, -22.031007, -15.997580, -4.526524, 6.839306, 14.139209, 16.317607, 15.185916, 14.167274, 16.468260, 23.508916, 34.261428, 45.706907, 54.130453, 56.649767, 52.333342, 42.496289, 30.136823, 18.820373, 11.493351, 9.667304, 13.206609, 20.690192, 30.113815, 39.622455, 48.014949, 54.896239, 60.498471, 65.297182, 69.590741, 73.196483, 75.365852, 74.952269, 70.791577, 62.185509, 49.328431, 33.507485, 16.954657, 2.336998, -7.989360, -12.717479, -12.037559, -7.587539, -1.876638, 2.632083, 4.431896, 3.499107, 1.194624, -0.447619, 0.236098, 3.611186, 8.357221, 11.834432, 11.097504, 4.157983, -9.035883, -26.339519, -44.022127, -58.032290, -65.422063, -65.355869, -59.297351, -50.309175, -41.771275, -36.062585, -33.756150, -33.646590, -33.563519, -31.584260, -27.091593, -21.198137, -16.342828, -15.231339, -19.581532, -29.223235, -41.953040, -54.225479, -62.409806, -64.105360, -58.985414, -48.835422, -36.781565, -26.031568, -18.639469, -14.786031, -12.850239, -10.226064, -4.542504, 5.210115, 18.101442, 31.464048, 41.804838, 46.077291, 42.829714, 32.794589, 18.698674, 4.368770, -6.529155, -11.648596, -10.598204, -4.840842, 3.072999, 10.614032, 16.278559, 20.094027, 23.437340, 28.255393, 36.017401, 46.836576, 59.132365, 69.990787, 76.104336, 74.943335, 65.717393, 49.763499, 30.213893, 11.065760, -4.008431, -12.687868, -14.522788, -10.802903, -3.874863, 3.800434, 10.490446, 15.643097, 19.830172, 24.264268, 30.121367, 37.947587, 47.364612, 57.150765, 65.626062, 71.169549, 72.678144, 69.832494, 63.130332, 53.733799, 43.219073, 33.306786, 25.610973, 21.406764, 21.410427, 25.593770, 33.096303, 42.317327, 51.238104, 57.940738, 61.187040, 60.849860, 57.998420, 54.543393, 52.517129, 53.231460, 56.642803, 61.210225, 64.359548, 63.426335, 56.740294, 44.426441, 28.581185, 12.711305, 0.613196, -4.898792, -2.931174, 5.247865, 16.761432, 28.252560, 37.140048, 42.501879, 45.238584, 47.464000, 51.389494, 58.178524, 67.263141, 76.424554, 82.622220, 83.240749, 77.241965, 65.738210, 51.732875, 39.112066, 31.278181, 29.964636, 34.698848, 43.117323, 51.991303, 58.537082, 61.478485, 61.442030, 60.547423, 61.387370, 65.833403, 74.161186, 84.842587, 95.070608, 101.787934, 102.801158, 97.551079, 87.268053, 74.494702, 62.198106, 52.826476, 47.649929, 46.583066, 48.488182, 51.785024, 55.107315, 57.766555, 59.885574, 62.197915, 65.622711, 70.784703, 77.647286, 85.375966, 92.473633, 97.150261, 97.825127, 93.620723, 84.701721, 72.344285, 58.688776, 46.220445, 37.114340, 32.640993, 32.831057, 36.528536, 41.837740, 46.827682, 50.251285, 52.011226, 53.178852, 55.529174, 60.740439, 69.551076, 81.208979, 93.462061, 103.147368, 107.205913, 103.769976, 92.915082, 76.771602, 58.921054, 43.275447, 32.846340, 28.864682, 30.582649, 35.819425, 42.011049, 47.316240, 51.307891, 54.959444, 59.944807, 67.577643, 77.884390, 89.255979, 98.871911, 103.744636, 101.945836, 93.479915, 80.411352, 66.171914, 54.329442, 47.332483, 45.749691, 48.298793, 52.610356, 56.355927, 58.229872, 58.367345, 58.056973, 58.932751, 62.054258, 67.309315, 73.397864, 78.372469, 80.457675, 78.763271, 73.585036, 66.200063, 58.300755, 51.358238, 46.200767, 42.953413, 41.293500, 40.831914, 41.400355, 43.111021, 46.199946, 50.784836, 56.700019, 63.505293, 70.647297, 77.654120, 84.224600, 90.144510, 95.081402, 98.406802, 99.207532, 96.560453, 89.996378, 79.946486, 67.923607, 56.275237, 47.526897, 43.533493, 44.777287, 50.128417, 57.215311, 63.302811, 66.351429, 65.832375, 62.949947, 60.151356, 60.093859, 64.470798, 73.173180, 84.145829, 94.029421, 99.366836, 97.919252, 89.579388, 76.512657, 62.448660, 51.373199, 46.107456, 47.312904, 53.305645, 60.759427, 66.037769, 66.651774, 62.285375, 54.987106, 48.439418, 46.566525, 51.997382, 64.963563, 83.056327, 101.949641, 116.835300, 124.049120, 122.295743, 113.031610, 99.882950, 87.335642, 79.197766, 77.402662, 81.568429, 89.423688, 97.874312, 104.255136, 107.271732, 107.296299, 105.963657, 105.296452, 106.757575, 110.621744, 115.893674, 120.758531, 123.338222, 122.428394, 117.933420, 110.865650, 102.956278, 96.061576, 91.594246, 90.164564, 91.515931, 94.733108, 98.626111, 102.161366, 104.816815, 106.764296, 108.821616, 112.167917, 117.880516, 126.420358, 137.242717, 148.708103, 158.394839, 163.777974, 163.083287, 156.016574, 144.066610, 130.205583, 118.028077, 110.596401, 109.399847, 113.821403, 121.332846, 128.371015, 131.590434, 129.043742, 120.868639, 109.244992, 97.652716, 89.705582, 87.969032, 93.151837, 103.912008, 117.302325, 129.679818, 137.779313, 139.630539, 135.070887, 125.736616, 114.561607, 104.938475, 99.777441, 100.720297, 107.726052, 119.146718, 132.274784, 144.200961, 152.715041, 156.954695, 157.577853, 156.391181, 155.561458, 156.697620, 160.152732, 164.824423, 168.548109, 168.946800, 164.415665, 154.856490, 141.867089, 128.301036, 117.359966, 111.563119, 111.981683, 118.011971, 127.740616, 138.720531, 148.826128, 156.849742, 162.634817, 166.751817, 169.916229, 172.442544, 173.988656, 173.696666, 170.649845, 164.424649, 155.479963, 145.202727, 135.580087, 128.624453, 125.773580, 127.488089, 133.180802, 141.478915, 150.697813, 159.340857, 166.451531, 171.720357, 175.353242, 177.798028, 179.468841, 180.590666, 181.219909]

# original = filtered[50:]

window = 30
filtered = np.convolve(original, np.ones(window), 'valid') / window
print("trend: ", filtered.tolist())
# original = original[window//2:]

filtered_again = np.array(original[window - 1:]) - filtered







print(filtered_again.tolist())
filtered_again **= 2
print(filtered_again.tolist())
# original = original[:400]
# filtered = filtered[:400]
# filtered_again = filtered_again[:400]

fig, axs = plt.subplots(3)
# no filter
axs[0].plot(np.arange(len(original)), original, color='b')
# filter
axs[0].plot(np.arange(len(filtered)), filtered, color='g')


if min(filtered_again) < 0:
    filtered_again += abs(min(filtered_again))

print("above x", filtered_again.tolist())

# filter again
axs[2].plot(np.arange(len(filtered_again)), filtered_again)

threshold = (max(filtered_again) - min(filtered_again)) / 4
print("threshold: ", threshold)
axs[2].axhline(y=threshold, color='r', linestyle='-')


bpm_count = 0
for i in range(len(filtered_again) - 1):
    if filtered_again[i] < threshold < filtered_again[i + 1]:
        axs[2].plot(i, filtered_again[i], 'r+')
        bpm_count += 1
    if filtered_again[i] > threshold > filtered_again[i + 1]:
        axs[2].plot(i, filtered_again[i], 'b+')
        bpm_count += 1

print(bpm_count//2)
# axs[0].plot(q_ppg_original, [original[i] for i in q_ppg_original], 'r+')
# axs[1].plot(q_ppg_filtered, [filtered[i] for i in q_ppg_filtered], 'r+')
# axs[2].plot(q_ppg_filtered_again, [filtered_again[i] for i in q_ppg_filtered_again], 'r+')
plt.show()
