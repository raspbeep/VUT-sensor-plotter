from scipy import signal
import numpy as np
import matplotlib.pyplot as plt
from qppg import q_ppg

data = [84008, 84031, 84028, 84024, 84031, 84035, 84064, 84079, 84097, 84110, 84133, 84146, 84162, 84162, 84185, 84197,
        84202, 84225, 84222, 84231, 84250, 84259, 84269, 84272, 84287, 84290, 84315, 84318, 84350, 84343, 84322, 84275,
        83956, 83907, 83858, 83872, 83884, 83896, 83911, 83933, 83915, 83934, 83938, 83975, 83994, 84017, 84029, 84029,
        84022, 84023, 84019, 84045, 84041, 84047, 84074, 84082, 84094, 84102, 84121, 84143, 84149, 84150, 84150, 84182,
        84183, 84186, 84216, 84221, 84229, 84227, 84246, 84256, 84269, 84284, 84291, 84288, 84237, 84129, 83996, 83914,
        83880, 83874, 83874, 83897, 83904, 83930, 83929, 83929, 83935, 83965, 83965, 83978, 83975, 83972, 83961, 83957,
        83922, 83929, 83929, 83904, 83899, 83868, 83866, 83849, 83850, 83833, 83829, 83825, 83815, 83820, 83808, 83801,
        83791, 83790, 83800, 83790, 83801, 83795, 83778, 83728, 83672, 83587, 83516, 83491, 83471, 83449, 83440, 83432,
        83426, 83405, 83412, 83410, 83429, 83423, 83438, 83437, 83436, 83428, 83437, 83442, 83445, 83453, 83449, 83467,
        83476, 83490, 83495, 83493, 83508, 83522, 83540, 83539, 83546, 83554, 83567, 83585, 83597, 83601, 83623, 83635,
        83633, 83649, 83654, 83679, 83673, 83710, 83718, 83722, 83703, 83633, 83561, 83506, 83435, 83408, 83404, 83413,
        83420, 83411, 83405, 83399, 83398, 83403, 83409, 83443, 83433, 83452, 83446, 83451, 83447, 83444, 83465, 83452,
        83471, 83486, 83488, 83514, 83523, 83527, 83545, 83556, 83560, 83577, 83585, 83595, 83613, 83611, 83624, 83645,
        83660, 83668, 83688, 83709, 83706, 83731, 83749, 83718, 83642, 83569, 83512, 83459, 83445, 83434, 83423, 83448,
        83471, 83461, 83449, 83452, 83460, 83469, 83485, 83479, 83485, 83498, 83501, 83491, 83507, 83518, 83517, 83535,
        83550, 83550, 83564, 83571, 83587, 83591, 83608, 83603, 83613, 83634, 83636, 83665, 83643, 83670, 83683, 83687,
        83684, 83714, 83711, 83685, 83618, 83567, 83537, 83518, 83507, 83517, 83523, 83534, 83547, 83551, 83545, 83553,
        83568, 83580, 83578, 83572, 83581, 83593, 83604, 83608, 83605, 83609, 83622, 83649, 83649, 83653, 83674, 83677,
        83674, 83702, 83702, 83708, 83724, 83747, 83744, 83762, 83777, 83785, 83808, 83809, 83803, 83772, 83713, 83659,
        83617, 83573, 83586, 83583, 83592, 83589, 83585, 83575, 83571, 83575, 83593, 83590, 83594, 83613, 83597, 83619,
        83614, 83615, 83632, 83620, 83635, 83641, 83655, 83660, 83664, 83685, 83694, 83693, 83711, 83717, 83723, 83742,
        83747, 83746, 83770, 83770, 83777, 83805, 83813, 83828, 83837, 83838, 83838, 83784, 83740, 83692, 83669, 83657,
        83638, 83648, 83643, 83639, 83653, 83647, 83644, 83670, 83680, 83682, 83695, 83697, 83699, 83694, 83703, 83722,
        83713, 83725, 83744, 83741, 83747, 83739, 83765, 83781, 83781, 83769, 83793, 83808, 83810, 83830, 83836, 83836,
        83847, 83869, 83890, 83889, 83890, 83854, 83828, 83786, 83750, 83742, 83731, 83747, 83744, 83741, 83752, 83757,
        83750, 83765, 83772, 83759, 83778, 83775, 83776, 83767, 83777, 83779, 83784, 83792, 83801, 83809, 83795, 83822,
        83842, 83842, 83830, 83838, 83852, 83866, 83879, 83886, 83898, 83925, 83929, 83937, 83914, 83889, 83844, 83801,
        83765, 83758, 83752, 83752, 83752, 83757, 83742, 83745, 83760, 83764, 83787, 83793, 83795, 83796, 83796, 83797,
        83801, 83809, 83820, 83837, 83834, 83850, 83856, 83867, 83878, 83879, 83881, 83897, 83907, 83917, 83907, 83912,
        83935, 83934, 83950, 83951, 83974, 83973, 83963, 83917, 83884, 83821, 83808, 83775, 83767, 83763, 83768, 83764,
        83750, 83755, 83764, 83770, 83793, 83795, 83800, 83807, 83804, 83809, 83817, 83806, 83827, 83826, 83845, 83833,
        83854, 83876, 83872, 83881, 83897, 83903, 83901, 83928, 83930, 83929, 83945, 83948, 83963, 83970, 83977, 83997,
        84011, 84017, 84043, 84046, 84051, 84029, 83986, 83930, 83894, 83863, 83851, 83858, 83846, 83865, 83852, 83854,
        83863, 83859, 83868, 83888, 83919, 83899, 83905, 83914, 83926, 83917, 83906, 83928, 83954, 83960, 83969, 83956,
        83980, 83996, 83994, 83998, 84007, 84019, 84034, 84026, 84048, 84047, 84055, 84072, 84074, 84067, 84061, 84021,
        83962, 83921, 83901, 83887, 83885, 83893, 83895, 83893, 83889, 83893, 83914, 83924, 83915, 83926, 83902, 83919,
        83929, 83943, 83945, 83958, 83961, 83950, 83968, 83975, 83967, 83985, 83996, 84007, 84006, 84016, 84017, 84031,
        84038, 84064, 84055, 84061, 84075, 84085, 84081, 84064, 84006, 83970, 83931, 83885, 83869, 83855, 83846, 83852,
        83849, 83841, 83834, 83840, 83833, 83853, 83847, 83840, 83860, 83865, 83868, 83865, 83878, 83884, 83903, 83893,
        83911, 83920, 83932, 83943, 83953, 83950, 83963, 83977, 83987, 83990, 83998, 84002, 84019, 84020, 84036, 84047,
        84060, 84079, 84073, 84038, 83990, 83939, 83888, 83857, 83833, 83825, 83825, 83816, 83824, 83823, 83819, 83826,
        83833, 83843, 83862, 83869, 83867, 83853, 83863, 83864, 83866, 83866, 83866, 83889, 83899, 83897, 83901, 83918,
        83936, 83936, 83928, 83939, 83945, 83949, 83951, 83953, 83969, 83983, 83991, 84006, 84008, 84018, 84004, 83969,
        83903, 83831, 83783, 83739, 83728, 83707, 83692, 83702, 83676, 83665, 83655, 83655, 83659, 83654, 83645, 83649,
        83626, 83607, 83607, 83591, 83597, 83581, 83594, 83610, 83597, 83595, 83604, 83617, 83602, 83619, 83624, 83621,
        83646, 83650, 83653, 83671, 83667, 83687, 83673, 83631, 83579, 83518, 83461, 83439, 83428, 83403, 83399, 83393,
        83358, 83378, 83392, 83397, 83405, 83420, 83427, 83419, 83424, 83427, 83436, 83453, 83446, 83469, 83470, 83475,
        83516, 83521, 83520, 83546, 83563, 83574, 83598, 83601, 83609, 83625, 83642, 83647, 83674, 83687, 83681, 83706,
        83708, 83641, 83594, 83536, 83497, 83449, 83431, 83437, 83422, 83439, 83430, 83408, 83418, 83427, 83434, 83451,
        83464, 83482, 83480, 83486, 83492, 83495, 83507, 83523, 83538, 83546, 83561, 83571, 83590, 83605, 83616, 83626,
        83627, 83658, 83663, 83678, 83694, 83708, 83740, 83750, 83756, 83779, 83782, 83805, 83804, 83814, 83824, 83822,
        83757, 83699, 83634, 83606, 83571, 83560, 83565, 83557, 83556, 83555, 83529, 83537, 83546, 83578, 83585, 83589]

data = [309882, 309880, 309887, 309879, 309865, 309833, 309832, 309821, 309816, 309826, 309852, 309872, 309891, 309927, 309918, 309913, 309922, 309913, 309898, 309893, 309865, 309880, 309880, 309893, 309887, 309897, 309890, 309898, 309904, 309882, 309899, 309905, 309898, 309894, 309888, 309886, 309872, 309885, 309891, 309895, 309867, 309862, 309868, 309832, 309814, 309820, 309818, 309822, 309816, 309811, 309826, 309819, 309819, 309825, 309826, 309833, 309845, 309838, 309808, 309805, 309843, 309828, 309828, 309827, 309825, 309821, 309834, 309843, 309819, 309829, 309836, 309831, 309821, 309839, 309831, 309842, 309833, 309846, 309833, 309826, 309819, 309806, 309773, 309799, 309801, 309809, 309805, 309811, 309806, 309788, 309808, 309808, 309804, 309794, 309817, 309807, 309783, 309782, 309797, 309804, 309803, 309809, 309806, 309802, 309818, 309826, 309806, 309791, 309812, 309820, 309812, 309815, 309825, 309834, 309836, 309839, 309844, 309842, 309827, 309801, 309782, 309811, 309819, 309820, 309837, 309854, 309866, 309853, 309850, 309872, 309885, 309890, 309895, 309883, 309879, 309888, 309892, 309901, 309924, 309924, 309909, 309899, 309912, 309909, 309912, 309899, 309906, 309907, 309902, 309913, 309910, 309918, 309922, 309924, 309910, 309919, 309898, 309873, 309863, 309860, 309869, 309887, 309894, 309873, 309878, 309873, 309884, 309879, 309868, 309869, 309880, 309886, 309875, 309868, 309871, 309878, 309884, 309883, 309887, 309887, 309885, 309901, 309886, 309900, 309887, 309884, 309897, 309889, 309880, 309888, 309906, 309908, 309906, 309884, 309898, 309888, 309886, 309834, 309829, 309815, 309814, 309815, 309833, 309833, 309822, 309818, 309831, 309826, 309839, 309826, 309830, 309850, 309838, 309826, 309823, 309834, 309843, 309835, 309824, 309838, 309858, 309847, 309848, 309868, 309859, 309847, 309856, 309857, 309840, 309844, 309872, 309875, 309851, 309863, 309868, 309864, 309839, 309815, 309805, 309783, 309778, 309789, 309802, 309820, 309821, 309814, 309799, 309814, 309817, 309818, 309819, 309844, 309831, 309826, 309821, 309841, 309854, 309844, 309848, 309828, 309832, 309830, 309847, 309851, 309834, 309821, 309836, 309819, 309842, 309852, 309829, 309843, 309857, 309852, 309846, 309837, 309822, 309801, 309790, 309792, 309800, 309809, 309800, 309793, 309787, 309792, 309787, 309779, 309786, 309792, 309783, 309763, 309763, 309763, 309783, 309779, 309787, 309794, 309791, 309790, 309796, 309793, 309801, 309793, 309795, 309799, 309783, 309788, 309790, 309803, 309820, 309793, 309767, 309749, 309742, 309726, 309711, 309711, 309723, 309710, 309702, 309697, 309688, 309691, 309698, 309705, 309682, 309664, 309655, 309658, 309665, 309677, 309669, 309654, 309645, 309657, 309646, 309651, 309651, 309629, 309645, 309653, 309648, 309637, 309657, 309661, 309666, 309654, 309646, 309642, 309620, 309625, 309646, 309631, 309647, 309641, 309647, 309663, 309663, 309664, 309685, 309674, 309677, 309671, 309673, 309685, 309709, 309691, 309688, 309689, 309703, 309720, 309734, 309734, 309721, 309703, 309723, 309722, 309726, 309728, 309737, 309752, 309782, 309763, 309753, 309744, 309716, 309707, 309730, 309725, 309719, 309722, 309729, 309713, 309713, 309686, 309704, 309698, 309685, 309681, 309696, 309680, 309709, 309723, 309718, 309709, 309700, 309720, 309725, 309732, 309733, 309762, 309783, 309756, 309750, 309755, 309759, 309764, 309792, 309797, 309781, 309779, 309748, 309749, 309726, 309716, 309724, 309740, 309748, 309737, 309737, 309719, 309714, 309710, 309727, 309732, 309734, 309727, 309733, 309734, 309736, 309741, 309751, 309750, 309776, 309774, 309773, 309782, 309789, 309788, 309772, 309765, 309782, 309785, 309760, 309769, 309785, 309787, 309795, 309780, 309753, 309740, 309711, 309708, 309718, 309734, 309742, 309745, 309719, 309724, 309725, 309722, 309728, 309720, 309736, 309726, 309699, 309702, 309722, 309738, 309723, 309733, 309736, 309742, 309750, 309747, 309744, 309749, 309756, 309755, 309787, 309790, 309771, 309788, 309787, 309782, 309758, 309739, 309722, 309714, 309700, 309695, 309715, 309714, 309722, 309710, 309693, 309692, 309711, 309719, 309712, 309698, 309702, 309711, 309724, 309723, 309718, 309727, 309729, 309741, 309746, 309746, 309754, 309771, 309757, 309753, 309755, 309747, 309747, 309753, 309774, 309768, 309754, 309722, 309706, 309677, 309667, 309670, 309667, 309691, 309665, 309673, 309681, 309670, 309652, 309660, 309675, 309663, 309665, 309654, 309657, 309679, 309687, 309679, 309678, 309671, 309682, 309691, 309688, 309686, 309691, 309692, 309682, 309681, 309682, 309682, 309682, 309697, 309701, 309695, 309661, 309636, 309621, 309603, 309592, 309605, 309583, 309583, 309604, 309590, 309579, 309581, 309588, 309599, 309594, 309596, 309589, 309575, 309550, 309565, 309606, 309598, 309582, 309585, 309602, 309606, 309622, 309630, 309628, 309619]

data1 = [2438.0, 2438.0, 2438.0, 2455.0, 2455.0, 2384.0, 2384.0, 2384.0, 2418.0, 2418.0, 2415.0, 2415.0, 2415.0, 2398.0,
         2398.0, 2388.0, 2388.0, 2388.0, 2340.0, 2340.0, 2340.0, 2340.0, 2340.0, 2399.0, 2399.0, 2353.0, 2353.0, 2353.0,
         2318.0, 2318.0, 2324.0, 2324.0, 2324.0, 2283.0, 2283.0, 2333.0, 2333.0, 2333.0, 2326.0, 2326.0, 2274.0, 2274.0,
         2274.0, 2309.0, 2309.0, 2224.0, 2224.0, 2224.0, 2288.0, 2288.0, 2268.0, 2268.0, 2268.0, 2250.0, 2250.0, 2251.0,
         2251.0, 2251.0, 2166.0, 2166.0, 2189.0, 2189.0, 2189.0, 2212.0, 2212.0, 2141.0, 2141.0, 2141.0, 2121.0, 2121.0,
         2175.0, 2175.0, 2175.0, 2099.0, 2099.0, 2098.0, 2098.0, 2098.0, 2146.0, 2146.0, 2068.0, 2068.0, 2068.0, 2116.0,
         2116.0, 2051.0, 2051.0, 2051.0, 2112.0, 2112.0, 2069.0, 2069.0, 2069.0, 2045.0, 2045.0, 2031.0, 2031.0, 2031.0,
         2081.0, 2081.0, 2083.0, 2083.0, 2083.0, 2060.0, 2060.0, 2019.0, 2019.0, 2019.0, 2063.0, 2063.0, 2004.0, 2004.0,
         2004.0, 1996.0, 1996.0, 2035.0, 2035.0, 2035.0, 1967.0, 1967.0, 2034.0, 2034.0, 2034.0, 1975.0, 1975.0, 1965.0,
         1965.0, 1965.0, 1978.0, 1978.0, 2015.0, 2015.0, 2015.0, 1974.0, 1974.0, 2010.0, 2010.0, 2010.0, 1946.0, 1946.0,
         2003.0, 2003.0, 2003.0, 1951.0, 1951.0, 1963.0, 1963.0, 1963.0, 1930.0, 1930.0, 1986.0, 1986.0, 1986.0, 1921.0,
         1921.0, 1929.0, 1929.0, 1920.0, 1920.0, 1920.0, 1925.0, 1925.0, 1922.0, 1922.0, 1922.0, 1981.0, 1981.0, 1939.0,
         1939.0, 1939.0, 1969.0, 1969.0, 1915.0, 1915.0, 1915.0, 1961.0, 1961.0, 1902.0, 1902.0, 1902.0, 1948.0, 1948.0,
         1903.0, 1903.0, 1903.0, 1926.0, 1926.0, 1903.0, 1903.0, 1903.0, 1902.0, 1902.0, 1945.0, 1945.0, 1945.0, 1929.0,
         1929.0, 1943.0, 1943.0, 1943.0, 1934.0, 1934.0, 1875.0, 1875.0, 1875.0, 1895.0, 1895.0, 1865.0, 1865.0, 1865.0,
         1861.0, 1861.0, 1872.0, 1872.0, 1872.0, 1879.0, 1879.0, 1844.0, 1844.0, 1844.0, 1881.0, 1881.0, 1898.0, 1898.0,
         1898.0, 1870.0, 1870.0, 1906.0, 1906.0, 1906.0, 1887.0, 1887.0, 1887.0, 1887.0, 1887.0, 1843.0, 1843.0, 1826.0,
         1826.0, 1826.0, 1891.0, 1891.0, 1849.0, 1849.0, 1849.0, 1852.0, 1852.0, 1878.0, 1878.0, 1878.0, 1810.0, 1810.0,
         1801.0, 1801.0, 1801.0, 1878.0, 1878.0, 1799.0, 1799.0, 1799.0, 1812.0, 1812.0, 1843.0, 1843.0, 1843.0, 1809.0,
         1809.0, 1844.0, 1844.0, 1844.0, 1782.0, 1782.0, 1820.0, 1820.0, 1820.0, 1776.0, 1776.0, 1825.0, 1825.0, 1825.0,
         1835.0, 1835.0, 1842.0, 1842.0, 1842.0, 1799.0, 1799.0, 1830.0, 1830.0, 1830.0, 1798.0, 1798.0, 1764.0, 1764.0,
         1764.0, 1830.0, 1830.0, 1813.0, 1813.0, 1813.0, 1817.0, 1817.0, 1812.0, 1812.0, 1812.0, 1739.0, 1739.0, 1775.0,
         1775.0, 1775.0, 1744.0, 1744.0, 1782.0, 1782.0, 1782.0, 1750.0, 1750.0, 1736.0, 1736.0, 1736.0, 1745.0, 1745.0,
         1764.0, 1764.0, 1764.0, 1780.0, 1780.0, 1776.0, 1776.0, 1776.0, 1792.0, 1792.0, 1788.0, 1788.0, 1788.0, 1774.0,
         1774.0, 1721.0, 1721.0, 1721.0, 1715.0, 1715.0, 1746.0, 1746.0, 1746.0, 1778.0, 1778.0, 1718.0, 1718.0, 1718.0,
         1721.0, 1721.0, 1765.0, 1765.0, 1765.0, 1715.0, 1715.0, 1747.0, 1747.0, 1727.0, 1727.0, 1727.0, 1707.0, 1707.0,
         1759.0, 1759.0, 1759.0, 1697.0, 1697.0, 1732.0, 1732.0, 1732.0, 1697.0, 1697.0, 1730.0, 1730.0, 1730.0, 1760.0,
         1760.0, 1760.0, 1760.0, 1760.0, 1739.0, 1739.0, 1688.0, 1688.0, 1688.0, 1759.0, 1759.0, 1738.0, 1738.0, 1738.0,
         1706.0, 1706.0, 1690.0, 1690.0, 1690.0, 1730.0, 1730.0, 1742.0, 1742.0, 1742.0, 1695.0, 1695.0, 1720.0, 1720.0,
         1720.0, 1735.0, 1735.0, 1749.0, 1749.0, 1749.0, 1698.0, 1698.0, 1725.0, 1725.0, 1725.0, 1726.0, 1726.0, 1747.0,
         1747.0, 1747.0, 1682.0, 1682.0, 1703.0, 1703.0, 1703.0, 1747.0, 1747.0, 1744.0, 1744.0, 1744.0, 1750.0, 1750.0,
         1702.0, 1702.0, 1702.0, 1760.0, 1760.0, 1739.0, 1739.0, 1739.0, 1720.0, 1720.0, 1774.0, 1774.0, 1774.0, 1727.0,
         1727.0, 1777.0, 1777.0, 1777.0, 1804.0, 1804.0, 1796.0, 1796.0, 1796.0, 1752.0, 1752.0, 1796.0, 1796.0, 1796.0,
         1853.0, 1853.0, 1805.0, 1805.0, 1805.0, 1824.0, 1824.0, 1905.0, 1905.0, 1905.0, 1934.0, 1934.0, 1937.0, 1937.0,
         1937.0, 1977.0, 1977.0, 1979.0, 1979.0, 1979.0, 2008.0, 2008.0, 1984.0, 1984.0, 1984.0, 2071.0, 2071.0, 2059.0,
         2059.0, 2059.0, 2067.0, 2067.0, 2126.0, 2126.0, 2126.0, 2112.0, 2112.0, 2128.0, 2128.0, 2128.0, 2167.0, 2167.0,
         2180.0, 2180.0, 2180.0, 2200.0, 2200.0, 2237.0, 2237.0, 2237.0, 2287.0, 2287.0, 2328.0, 2328.0, 2328.0, 2350.0,
         2350.0, 2317.0, 2317.0, 2317.0, 2314.0, 2314.0, 2332.0, 2332.0, 2332.0, 2359.0, 2359.0, 2399.0, 2399.0, 2399.0,
         2384.0, 2384.0, 2454.0, 2454.0, 2454.0, 2474.0, 2474.0, 2493.0, 2493.0, 2493.0, 2497.0, 2497.0, 2468.0, 2468.0,
         2468.0, 2524.0, 2524.0, 2478.0, 2478.0, 2478.0, 2534.0, 2534.0, 2499.0, 2499.0, 2499.0, 2549.0, 2549.0, 2547.0,
         2547.0, 2547.0, 2533.0, 2533.0, 2510.0, 2510.0, 2572.0, 2572.0, 2572.0, 2556.0, 2556.0, 2540.0, 2540.0, 2540.0,
         2587.0, 2587.0, 2577.0, 2577.0, 2577.0, 2584.0, 2584.0, 2554.0, 2554.0, 2554.0, 2512.0, 2512.0, 2518.0, 2518.0,
         2518.0, 2564.0, 2564.0, 2570.0, 2570.0, 2570.0, 2516.0, 2516.0, 2553.0, 2553.0, 2553.0, 2560.0, 2560.0, 2566.0,
         2566.0, 2566.0, 2487.0, 2487.0, 2487.0, 2487.0, 2487.0, 2484.0, 2484.0, 2484.0, 2484.0, 2484.0, 2482.0, 2482.0,
         2529.0, 2529.0, 2529.0, 2475.0, 2475.0, 2460.0, 2460.0, 2460.0, 2471.0, 2471.0, 2432.0, 2432.0, 2432.0, 2454.0,
         2454.0, 2489.0, 2489.0, 2489.0, 2479.0, 2479.0, 2439.0, 2439.0, 2439.0, 2392.0, 2392.0, 2432.0, 2432.0, 2432.0,
         2443.0, 2443.0, 2356.0, 2356.0, 2356.0, 2352.0, 2352.0, 2382.0, 2382.0, 2382.0, 2321.0, 2321.0, 2376.0, 2376.0,
         2376.0, 2306.0, 2306.0, 2354.0, 2354.0, 2354.0, 2278.0, 2278.0, 2287.0, 2287.0, 2287.0, 2270.0, 2270.0, 2295.0,
         2295.0, 2295.0, 2274.0, 2274.0, 2254.0, 2254.0, 2254.0, 2263.0, 2263.0, 2252.0, 2252.0, 2252.0, 2196.0, 2196.0,
         2206.0, 2206.0, 2206.0, 2164.0, 2164.0, 2151.0, 2151.0, 2151.0, 2143.0, 2143.0, 2142.0, 2142.0, 2142.0, 2122.0,
         2122.0, 2141.0, 2141.0, 2141.0, 2136.0, 2136.0, 2120.0, 2120.0, 2120.0, 2106.0, 2106.0, 2162.0, 2162.0, 2162.0,
         2097.0, 2097.0, 2128.0, 2128.0, 2128.0, 2120.0, 2120.0, 2096.0, 2096.0, 2096.0, 2056.0, 2056.0, 2090.0, 2090.0,
         2090.0, 2047.0, 2047.0, 2099.0, 2099.0, 2099.0, 2031.0, 2031.0, 2022.0, 2022.0, 2022.0, 2031.0, 2031.0, 2006.0,
         2006.0, 2006.0, 2066.0, 2066.0, 2037.0, 2037.0, 2037.0, 2028.0, 2028.0, 2015.0, 2015.0, 2015.0, 2059.0, 2059.0,
         2036.0, 2036.0, 2036.0, 2008.0, 2008.0, 2002.0, 2002.0, 2002.0, 2004.0, 2004.0, 2054.0, 2054.0, 2059.0, 2059.0,
         2059.0, 2031.0, 2031.0, 2002.0, 2002.0, 2002.0, 1980.0, 1980.0, 2044.0, 2044.0, 2044.0, 1987.0, 1987.0, 2027.0,
         2027.0, 2027.0, 1992.0, 1992.0, 2022.0, 2022.0, 2022.0, 1966.0, 1966.0, 1979.0, 1979.0, 1979.0, 1963.0, 1963.0,
         1987.0, 1987.0, 1987.0, 1966.0, 1966.0, 1969.0, 1969.0, 1969.0, 1959.0, 1959.0, 2019.0, 2019.0, 2019.0, 1975.0,
         1975.0, 1942.0, 1942.0, 1942.0, 1994.0, 1994.0, 1964.0, 1964.0, 1964.0, 1978.0, 1978.0, 2001.0, 2001.0, 2001.0,
         1921.0, 1921.0, 1937.0, 1937.0, 1937.0, 1937.0, 1937.0, 1998.0, 1998.0, 1998.0, 1936.0, 1936.0, 1930.0, 1930.0,
         1930.0, 1951.0, 1951.0, 1968.0, 1968.0, 1968.0, 1980.0, 1980.0, 1915.0, 1915.0, 1915.0, 1959.0, 1959.0, 1896.0,
         1896.0, 1896.0, 1893.0, 1893.0, 1961.0, 1961.0, 1961.0, 1883.0, 1883.0, 1933.0, 1933.0, 1933.0, 1940.0, 1940.0,
         1885.0, 1885.0, 1885.0, 1871.0, 1871.0, 1935.0, 1935.0, 1935.0, 1878.0, 1878.0, 1910.0, 1910.0, 1910.0, 1933.0,
         1933.0, 1868.0, 1868.0, 1868.0, 1922.0, 1922.0, 1883.0, 1883.0, 1883.0, 1908.0, 1908.0, 1844.0, 1844.0, 1844.0,
         1851.0, 1851.0, 1851.0, 1851.0, 1851.0, 1898.0, 1898.0, 1876.0, 1876.0, 1876.0, 1887.0, 1887.0, 1821.0, 1821.0,
         1821.0, 1868.0, 1868.0, 1833.0, 1833.0, 1833.0, 1868.0, 1868.0, 1878.0, 1878.0, 1878.0, 1809.0, 1809.0, 1857.0,
         1857.0, 1857.0, 1791.0, 1791.0, 1792.0, 1792.0, 1792.0, 1860.0, 1860.0, 1845.0, 1845.0, 1845.0, 1829.0, 1829.0,
         1821.0, 1821.0, 1821.0, 1822.0, 1822.0, 1818.0, 1818.0, 1818.0, 1831.0, 1831.0, 1826.0, 1826.0, 1826.0, 1759.0,
         1759.0, 1750.0, 1750.0, 1750.0, 1737.0, 1737.0, 1753.0, 1753.0, 1753.0, 1811.0, 1811.0, 1800.0, 1800.0, 1800.0,
         1809.0, 1809.0, 1731.0, 1731.0, 1779.0, 1779.0, 1779.0, 1730.0, 1730.0, 1802.0, 1802.0, 1802.0, 1764.0, 1764.0,
         1725.0, 1725.0, 1725.0, 1773.0, 1773.0, 1722.0, 1722.0, 1722.0, 1783.0, 1783.0, 1785.0, 1785.0, 1785.0, 1775.0,
         1775.0, 1758.0, 1758.0, 1758.0, 1747.0, 1747.0, 1735.0, 1735.0, 1735.0, 1771.0, 1771.0, 1775.0, 1775.0, 1775.0,
         1798.0, 1798.0, 1735.0, 1735.0, 1735.0, 1739.0, 1739.0, 1731.0, 1731.0, 1731.0, 1789.0, 1789.0, 1719.0, 1719.0,
         1719.0, 1722.0, 1722.0, 1729.0, 1729.0, 1729.0, 1731.0, 1731.0, 1723.0, 1723.0, 1723.0, 1788.0, 1788.0, 1794.0,
         1794.0, 1794.0, 1723.0, 1723.0, 1721.0, 1721.0, 1721.0, 1751.0, 1751.0, 1792.0, 1792.0, 1792.0, 1791.0, 1791.0,
         1742.0, 1742.0, 1742.0, 1743.0, 1743.0, 1762.0, 1762.0, 1762.0, 1845.0, 1845.0, 1789.0, 1789.0, 1789.0, 1837.0,
         1837.0, 1806.0, 1806.0, 1806.0, 1836.0, 1836.0, 1841.0, 1841.0, 1841.0, 1880.0, 1880.0, 1872.0, 1872.0, 1872.0,
         1934.0, 1934.0, 1895.0, 1895.0, 1895.0, 1939.0, 1939.0, 1943.0, 1943.0, 1943.0, 1959.0, 1959.0, 2058.0, 2058.0,
         2058.0, 2051.0, 2051.0, 2089.0, 2089.0, 2089.0, 2116.0, 2116.0, 2099.0, 2099.0, 2099.0, 2117.0, 2117.0, 2142.0,
         2142.0, 2142.0, 2210.0, 2210.0, 2227.0, 2227.0, 2227.0, 2252.0, 2252.0, 2223.0, 2223.0, 2223.0, 2255.0, 2255.0,
         2250.0, 2250.0, 2250.0, 2270.0, 2270.0, 2289.0, 2289.0, 2289.0, 2366.0, 2366.0, 2339.0, 2339.0, 2339.0, 2417.0,
         2417.0, 2415.0, 2415.0, 2415.0, 2407.0, 2407.0, 2419.0, 2419.0, 2419.0, 2401.0, 2401.0, 2481.0, 2481.0, 2481.0,
         2493.0, 2493.0, 2499.0, 2499.0, 2499.0, 2516.0, 2516.0, 2468.0, 2468.0, 2468.0, 2507.0, 2507.0, 2496.0, 2496.0,
         2496.0, 2523.0, 2523.0, 2513.0, 2513.0, 2513.0, 2540.0, 2540.0, 2492.0, 2492.0, 2492.0, 2572.0, 2572.0, 2525.0,
         2525.0, 2537.0, 2537.0, 2537.0, 2511.0, 2511.0, 2510.0, 2510.0, 2510.0, 2535.0, 2535.0, 2497.0, 2497.0, 2497.0,
         2566.0, 2566.0, 2499.0, 2499.0, 2499.0, 2539.0, 2539.0, 2514.0, 2514.0, 2514.0, 2539.0, 2539.0, 2481.0, 2481.0,
         2481.0, 2532.0, 2532.0, 2473.0, 2473.0, 2473.0, 2496.0, 2496.0, 2516.0, 2516.0, 2516.0, 2477.0, 2477.0, 2440.0,
         2440.0, 2440.0, 2439.0, 2439.0, 2467.0, 2467.0, 2467.0, 2462.0, 2462.0, 2475.0, 2475.0, 2475.0, 2455.0, 2455.0,
         2399.0, 2399.0, 2399.0, 2448.0, 2448.0, 2422.0, 2422.0, 2422.0, 2414.0, 2414.0, 2352.0, 2352.0, 2352.0, 2396.0,
         2396.0, 2318.0, 2318.0, 2318.0, 2323.0, 2323.0, 2371.0, 2371.0, 2371.0, 2346.0, 2346.0, 2309.0, 2309.0, 2309.0,
         2310.0, 2310.0, 2265.0, 2265.0, 2265.0, 2316.0, 2316.0, 2230.0, 2230.0, 2230.0, 2225.0, 2225.0, 2215.0, 2215.0,
         2215.0, 2264.0, 2264.0, 2251.0, 2251.0, 2251.0, 2217.0, 2217.0, 2231.0, 2231.0, 2231.0, 2223.0, 2223.0, 2147.0,
         2147.0, 2147.0, 2181.0, 2181.0, 2132.0, 2132.0, 2132.0, 2107.0, 2107.0, 2136.0, 2136.0, 2136.0, 2155.0, 2155.0,
         2087.0, 2087.0, 2087.0, 2121.0, 2121.0, 2059.0, 2059.0, 2059.0, 2115.0, 2115.0, 2056.0, 2056.0, 2056.0, 2118.0,
         2118.0, 2050.0, 2050.0, 2050.0, 2031.0, 2031.0, 2092.0, 2092.0, 2092.0, 2084.0, 2084.0, 2019.0, 2019.0, 2019.0,
         2064.0, 2064.0, 2008.0, 2008.0, 2008.0, 2000.0, 2000.0, 2066.0, 2066.0, 2066.0, 2066.0, 2066.0, 2010.0, 2010.0,
         2010.0, 2042.0, 2042.0, 2056.0, 2056.0, 2056.0, 1984.0, 1984.0, 2050.0, 2050.0, 2050.0, 2025.0, 2025.0, 2020.0,
         2020.0, 2020.0, 1970.0, 1970.0, 1976.0, 1976.0, 1976.0, 2042.0, 2042.0, 1965.0, 1965.0, 1965.0, 2022.0, 2022.0,
         2022.0, 2022.0, 2022.0, 1974.0, 1974.0, 2036.0, 2036.0, 2027.0, 2027.0, 2027.0, 1990.0, 1990.0, 2006.0, 2006.0,
         2006.0, 1996.0, 1996.0, 1991.0, 1991.0, 1991.0, 1995.0, 1995.0, 1956.0, 1956.0, 1956.0, 1953.0, 1953.0, 2011.0,
         2011.0, 2011.0, 1988.0, 1988.0, 1976.0, 1976.0, 1976.0, 1935.0, 1935.0, 1937.0, 1937.0, 1937.0, 1997.0, 1997.0,
         1987.0, 1987.0, 1987.0, 1923.0, 1923.0, 1988.0, 1988.0, 1988.0, 1959.0, 1959.0, 1924.0, 1924.0, 1924.0, 1938.0,
         1938.0, 1900.0, 1900.0, 1900.0, 1900.0, 1900.0, 1910.0, 1910.0, 1910.0, 1938.0, 1938.0, 1894.0, 1894.0, 1894.0,
         1935.0, 1935.0, 1954.0, 1954.0, 1954.0, 1915.0, 1915.0, 1912.0, 1912.0, 1912.0, 1903.0, 1903.0, 1929.0, 1929.0,
         1929.0, 1866.0, 1866.0, 1880.0, 1880.0, 1880.0, 1904.0, 1904.0, 1932.0, 1932.0, 1932.0, 1887.0, 1887.0, 1922.0,
         1922.0, 1922.0, 1913.0, 1913.0, 1861.0, 1861.0, 1861.0, 1846.0, 1846.0, 1879.0, 1879.0, 1879.0, 1836.0, 1836.0,
         1852.0, 1852.0, 1852.0, 1841.0, 1841.0, 1911.0, 1911.0, 1911.0, 1902.0, 1902.0, 1879.0, 1879.0, 1879.0, 1808.0,
         1808.0, 1867.0, 1867.0, 1867.0, 1836.0, 1836.0, 1868.0, 1868.0, 1868.0, 1870.0, 1870.0, 1805.0, 1805.0, 1805.0,
         1850.0, 1850.0, 1844.0, 1844.0, 1844.0, 1852.0, 1852.0, 1781.0, 1781.0, 1781.0, 1794.0, 1794.0, 1828.0, 1828.0,
         1828.0, 1792.0, 1792.0, 1800.0, 1800.0, 1800.0, 1776.0, 1776.0, 1773.0, 1773.0, 1773.0, 1823.0, 1823.0, 1795.0,
         1795.0, 1795.0, 1825.0, 1825.0, 1805.0, 1805.0, 1805.0, 1817.0, 1817.0, 1814.0, 1814.0, 1814.0, 1770.0, 1770.0,
         1804.0, 1804.0, 1804.0, 1797.0, 1797.0, 1752.0, 1752.0, 1752.0, 1742.0, 1742.0, 1729.0, 1729.0, 1729.0, 1737.0,
         1737.0, 1793.0, 1793.0, 1793.0, 1740.0, 1740.0, 1744.0, 1744.0, 1744.0, 1744.0, 1744.0, 1752.0, 1752.0, 1765.0,
         1765.0, 1765.0, 1727.0, 1727.0, 1721.0, 1721.0, 1721.0, 1784.0, 1784.0, 1724.0, 1724.0, 1724.0, 1729.0, 1729.0,
         1734.0, 1734.0, 1734.0, 1756.0, 1756.0, 1728.0, 1728.0, 1728.0, 1715.0, 1715.0, 1728.0, 1728.0, 1728.0, 1705.0,
         1705.0, 1724.0, 1724.0, 1724.0, 1711.0, 1711.0, 1754.0, 1754.0, 1754.0, 1716.0, 1716.0, 1740.0, 1740.0, 1740.0,
         1774.0, 1774.0, 1774.0, 1774.0, 1774.0, 1701.0, 1701.0, 1702.0, 1702.0, 1702.0, 1762.0, 1762.0, 1736.0, 1736.0,
         1736.0, 1773.0, 1773.0, 1706.0, 1706.0, 1706.0, 1735.0, 1735.0, 1740.0, 1740.0, 1740.0, 1776.0, 1776.0, 1735.0,
         1735.0, 1735.0, 1696.0, 1696.0, 1738.0, 1738.0, 1738.0, 1761.0, 1761.0, 1732.0, 1732.0, 1732.0, 1734.0, 1734.0,
         1788.0, 1788.0, 1788.0, 1745.0, 1745.0, 1822.0, 1822.0, 1822.0, 1814.0, 1814.0, 1849.0, 1849.0, 1849.0, 1877.0,
         1877.0, 1881.0, 1881.0, 1881.0, 1899.0, 1899.0, 1865.0, 1865.0, 1865.0, 1897.0, 1897.0, 1911.0, 1911.0, 1911.0,
         1982.0, 1982.0, 1984.0, 1984.0, 1984.0, 2041.0, 2041.0, 2020.0, 2020.0, 2020.0, 2088.0, 2088.0, 2107.0, 2107.0,
         2107.0, 2072.0, 2072.0, 2106.0, 2106.0, 2106.0, 2111.0, 2111.0, 2127.0, 2127.0, 2127.0, 2211.0, 2211.0, 2218.0,
         2218.0, 2218.0, 2213.0, 2213.0, 2254.0, 2254.0, 2254.0, 2237.0, 2237.0, 2299.0, 2299.0, 2299.0, 2275.0, 2275.0,
         2292.0, 2292.0, 2292.0, 2372.0, 2372.0, 2327.0, 2327.0, 2327.0, 2410.0, 2410.0, 2337.0, 2337.0, 2337.0, 2422.0,
         2422.0, 2452.0, 2452.0, 2452.0, 2457.0, 2457.0, 2471.0, 2471.0, 2471.0, 2448.0, 2448.0, 2440.0, 2440.0, 2440.0,
         2479.0, 2479.0, 2435.0, 2435.0, 2435.0, 2499.0, 2499.0, 2500.0, 2500.0, 2500.0, 2450.0, 2450.0, 2470.0, 2470.0,
         2470.0, 2472.0, 2472.0, 2466.0, 2466.0, 2466.0, 2482.0, 2482.0, 2482.0, 2482.0, 2518.0, 2518.0, 2518.0, 2489.0,
         2489.0, 2515.0, 2515.0, 2515.0, 2480.0, 2480.0, 2420.0, 2420.0, 2420.0, 2430.0, 2430.0, 2467.0, 2467.0, 2467.0,
         2464.0, 2464.0, 2426.0, 2426.0, 2426.0, 2450.0, 2450.0, 2438.0, 2438.0, 2438.0, 2422.0, 2422.0, 2444.0, 2444.0,
         2444.0, 2442.0, 2442.0, 2443.0, 2443.0, 2443.0, 2429.0, 2429.0, 2358.0, 2358.0, 2358.0, 2370.0, 2370.0, 2337.0,
         2337.0, 2337.0, 2376.0, 2376.0, 2324.0, 2324.0, 2324.0, 2319.0, 2319.0, 2292.0, 2292.0, 2292.0, 2323.0, 2323.0,
         2302.0, 2302.0, 2302.0, 2263.0, 2263.0, 2247.0, 2247.0, 2247.0, 2264.0, 2264.0, 2287.0, 2287.0, 2287.0, 2280.0,
         2280.0, 2199.0, 2199.0, 2199.0, 2245.0, 2245.0, 2191.0, 2191.0, 2191.0, 2164.0, 2164.0, 2219.0, 2219.0, 2219.0,
         2176.0, 2176.0, 2138.0, 2138.0, 2138.0, 2172.0, 2172.0, 2135.0, 2135.0, 2135.0, 2106.0, 2106.0, 2089.0, 2089.0,
         2089.0, 2074.0, 2074.0, 2076.0, 2076.0, 2076.0, 2043.0, 2043.0, 2091.0, 2091.0, 2091.0, 2054.0, 2054.0, 2058.0,
         2058.0, 2058.0, 2067.0, 2067.0, 2016.0, 2016.0, 2016.0, 2027.0, 2027.0, 2066.0, 2066.0, 2066.0, 2032.0, 2032.0,
         2058.0, 2058.0, 2058.0, 1989.0, 1989.0, 1973.0, 1973.0, 1973.0, 1966.0, 1966.0, 1959.0, 1959.0, 1959.0, 1992.0,
         1992.0, 2024.0, 2024.0, 2024.0, 1999.0, 1999.0, 2013.0, 2013.0, 2013.0, 1994.0, 1994.0, 1972.0, 1972.0, 1972.0,
         1932.0, 1932.0, 2006.0, 2006.0, 2006.0, 1990.0, 1990.0, 1986.0, 1986.0, 1986.0, 1925.0, 1925.0, 1989.0, 1989.0,
         1989.0, 1966.0, 1966.0, 1933.0, 1933.0, 1933.0, 1922.0, 1922.0, 1985.0, 1985.0, 1985.0, 1937.0, 1937.0, 1966.0,
         1966.0, 1966.0, 1965.0, 1965.0, 1982.0, 1982.0, 1982.0, 1951.0, 1951.0, 1907.0, 1907.0, 1907.0, 1927.0, 1927.0,
         1932.0, 1932.0, 1929.0, 1929.0, 1929.0, 1947.0, 1947.0, 1899.0, 1899.0, 1899.0, 1950.0, 1950.0, 1908.0, 1908.0,
         1908.0, 1882.0, 1882.0, 1915.0, 1915.0, 1915.0, 1917.0, 1917.0, 1936.0, 1936.0, 1936.0, 1892.0, 1892.0, 1929.0,
         1929.0, 1929.0, 1906.0, 1906.0, 1934.0, 1934.0, 1934.0, 1902.0, 1902.0, 1859.0, 1859.0, 1859.0, 1855.0, 1855.0,
         1867.0, 1867.0, 1867.0, 1850.0, 1850.0, 1837.0, 1837.0, 1837.0, 1903.0, 1903.0, 1833.0, 1833.0, 1833.0, 1900.0,
         1900.0, 1882.0, 1882.0, 1882.0, 1827.0, 1827.0, 1825.0, 1825.0, 1825.0, 1855.0, 1855.0, 1832.0, 1832.0, 1832.0,
         1876.0, 1876.0, 1811.0, 1811.0, 1811.0, 1873.0, 1873.0, 1825.0, 1825.0, 1825.0, 1828.0, 1828.0, 1864.0, 1864.0,
         1864.0, 1863.0, 1863.0, 1811.0, 1811.0, 1811.0, 1795.0, 1795.0, 1790.0, 1790.0, 1790.0, 1787.0, 1787.0, 1831.0,
         1831.0, 1831.0, 1776.0, 1776.0, 1766.0, 1766.0, 1766.0, 1833.0, 1833.0, 1827.0, 1827.0, 1827.0, 1754.0, 1754.0]

filter_order = 4
band_attenuation = 5
cutoff_frequencies = [0.6, 3.5]
filter_type = 'bandpass'
sampling_frequency = 30

sos = signal.cheby2(filter_order, band_attenuation, cutoff_frequencies,
                    btype=filter_type, fs=sampling_frequency, output='sos')
filtered = signal.sosfiltfilt(sos, data)
vals_x = np.arange(len(data))

peaks_data_x = q_ppg(data)
peaks_data_y = [data[i] for i in peaks_data_x]

peaks_filtered_x = q_ppg(filtered)
peaks_filtered_y = [filtered[i] for i in peaks_filtered_x]

fig, axs = plt.subplots(2)
# print(data)
# print(filtered)
fr = 0
to = len(data)
axs[0].plot(vals_x[fr:to], data[fr:to])
axs[0].plot(peaks_data_x, peaks_data_y, 'r+')

axs[1].plot(vals_x[fr:to], filtered[fr:to])
axs[1].plot(peaks_filtered_x, peaks_filtered_y, 'r+')
plt.show()


def filter_data(data_input):
    sos_params = signal.cheby2(filter_order, band_attenuation, cutoff_frequencies,
                        btype=filter_type, fs=sampling_frequency, output='sos')
    return signal.sosfiltfilt(sos_params, data_input)
